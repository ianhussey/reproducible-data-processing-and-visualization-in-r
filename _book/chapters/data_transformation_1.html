<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Data transformation I – Reproducible Data Processing and Visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/data_transformation_2.html" rel="next">
<link href="../chapters/the_pipe_and_renaming.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/data_transformation_1.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data transformation I</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Reproducible Data Processing and Visualization</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Installation and setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Fundamentals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/reproducible_reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reproducible reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/loading_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Loading, viewing, and saving data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/the_pipe_and_renaming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The pipe and renaming</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data_transformation_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data transformation I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data_transformation_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data transformation II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/strings_and_factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Working with strings and factors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/reshaping_and_pivots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Reshaping and pivots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/binding_and_joining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Binding and joining</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/structuring_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Structuring projects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/reporting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reporting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/privacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data privacy and anonymity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">License and citation</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#keeping-or-dropping-columns-with-dplyrselect" id="toc-keeping-or-dropping-columns-with-dplyrselect" class="nav-link active" data-scroll-target="#keeping-or-dropping-columns-with-dplyrselect"><span class="header-section-number">6.1</span> Keeping or dropping columns with <code>dplyr::select()</code></a>
  <ul class="collapse">
  <li><a href="#positive-vs.-negative-selections" id="toc-positive-vs.-negative-selections" class="nav-link" data-scroll-target="#positive-vs.-negative-selections"><span class="header-section-number">6.1.1</span> Positive vs.&nbsp;negative selections</a></li>
  <li><a href="#tidyselect-helper-functions" id="toc-tidyselect-helper-functions" class="nav-link" data-scroll-target="#tidyselect-helper-functions"><span class="header-section-number">6.1.2</span> {tidyselect} helper functions</a></li>
  <li><a href="#selection-with-set-operations" id="toc-selection-with-set-operations" class="nav-link" data-scroll-target="#selection-with-set-operations"><span class="header-section-number">6.1.3</span> Selection with set operations</a></li>
  <li><a href="#practicing-select-and-the-pipe-in-a-longer-chunk" id="toc-practicing-select-and-the-pipe-in-a-longer-chunk" class="nav-link" data-scroll-target="#practicing-select-and-the-pipe-in-a-longer-chunk"><span class="header-section-number">6.1.4</span> Practicing select and the pipe in a longer chunk</a></li>
  </ul></li>
  <li><a href="#moving-columns-with-dplyrrelocate" id="toc-moving-columns-with-dplyrrelocate" class="nav-link" data-scroll-target="#moving-columns-with-dplyrrelocate"><span class="header-section-number">6.2</span> Moving columns with <code>dplyr::relocate()</code></a></li>
  <li><a href="#renaming-relocating-and-selecting-all-in-one-with-select" id="toc-renaming-relocating-and-selecting-all-in-one-with-select" class="nav-link" data-scroll-target="#renaming-relocating-and-selecting-all-in-one-with-select"><span class="header-section-number">6.3</span> Renaming, relocating, and selecting all-in-one with <code>select()</code></a></li>
  <li><a href="#keeping-or-dropping-rows-with-dplyrfilter" id="toc-keeping-or-dropping-rows-with-dplyrfilter" class="nav-link" data-scroll-target="#keeping-or-dropping-rows-with-dplyrfilter"><span class="header-section-number">6.4</span> Keeping or dropping rows with <code>dplyr::filter()</code></a>
  <ul class="collapse">
  <li><a href="#filters-with-set-operations" id="toc-filters-with-set-operations" class="nav-link" data-scroll-target="#filters-with-set-operations"><span class="header-section-number">6.4.1</span> Filters with set operations</a></li>
  <li><a href="#positive-vs.-negative-filters" id="toc-positive-vs.-negative-filters" class="nav-link" data-scroll-target="#positive-vs.-negative-filters"><span class="header-section-number">6.4.2</span> Positive vs.&nbsp;negative filters</a></li>
  </ul></li>
  <li><a href="#creating-and-modifying-columns-with-dplyrmutate" id="toc-creating-and-modifying-columns-with-dplyrmutate" class="nav-link" data-scroll-target="#creating-and-modifying-columns-with-dplyrmutate"><span class="header-section-number">6.5</span> Creating and modifying columns with <code>dplyr::mutate()</code></a>
  <ul class="collapse">
  <li><a href="#longer-pipes" id="toc-longer-pipes" class="nav-link" data-scroll-target="#longer-pipes"><span class="header-section-number">6.5.1</span> Longer pipes</a></li>
  <li><a href="#more-complex-mutates" id="toc-more-complex-mutates" class="nav-link" data-scroll-target="#more-complex-mutates"><span class="header-section-number">6.5.2</span> More complex mutates</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">6.6</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#select-vs.-filter" id="toc-select-vs.-filter" class="nav-link" data-scroll-target="#select-vs.-filter"><span class="header-section-number">6.6.1</span> <code>select()</code> vs.&nbsp;<code>filter()</code></a></li>
  <li><a href="#tidyselect-helper-functions-1" id="toc-tidyselect-helper-functions-1" class="nav-link" data-scroll-target="#tidyselect-helper-functions-1"><span class="header-section-number">6.6.2</span> {tidyselect} helper functions</a></li>
  <li><a href="#positive-vs.-negative-selections-and-filters" id="toc-positive-vs.-negative-selections-and-filters" class="nav-link" data-scroll-target="#positive-vs.-negative-selections-and-filters"><span class="header-section-number">6.6.3</span> Positive vs.&nbsp;negative selections and filters</a></li>
  <li><a href="#set-operators" id="toc-set-operators" class="nav-link" data-scroll-target="#set-operators"><span class="header-section-number">6.6.4</span> Set operators</a></li>
  <li><a href="#interactive-exercises" id="toc-interactive-exercises" class="nav-link" data-scroll-target="#interactive-exercises"><span class="header-section-number">6.6.5</span> Interactive exercises</a></li>
  <li><a href="#practice-data-transformation-using-multiple-functions" id="toc-practice-data-transformation-using-multiple-functions" class="nav-link" data-scroll-target="#practice-data-transformation-using-multiple-functions"><span class="header-section-number">6.6.6</span> Practice data transformation using multiple functions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data transformation I</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The next few chapters cover various {tidyverse} functions - sometimes called verbs - that are used for data transformation.</p>
<p>This chapter covers functions that are “<em>non-aggregating</em>”: they allow you to change which columns or rows are present in the dataset, to create new columns or split up existing ones, to change their contents, etc. <code>rename()</code>, which you learned in the previous chapter, is one of these functions.</p>
<section id="keeping-or-dropping-columns-with-dplyrselect" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="keeping-or-dropping-columns-with-dplyrselect"><span class="header-section-number">6.1</span> Keeping or dropping columns with <code>dplyr::select()</code></h2>
<p>Not all columns in a dataset are useful to us. When processing data, we often wish to keep only some columns and drop others. We can do this with <code>dplyr::select()</code>.</p>
<p>We’ll start where the last chapter ended, by loading dependencies, reading in the ‘data_demographics_raw_messy.csv’ dataset, and renaming the columns to make them easier to work with.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># for read_csv()</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="co"># for clean_names()</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># for %&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># for kable()</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># for kable_extra()</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="ot">&lt;-</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"../data/raw/data_demographics_raw_messy.csv"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> subject_code, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">block_trial =</span> block_code_and_trial_number, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">question =</span> trial_code, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">response =</span> key_response_use_this, </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">rt =</span> x0_ms_onset_rt)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">OCD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">ad;oi98732paisdh</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">1023984cao982738</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4311</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">GAD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6887</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">2982879q8w7r</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6887</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If our data processing goal is to extract and tidy responses on the demographics questionnaire, we only need some of these columns: id, question, and response. We can use <code>select()</code> and the pipe to retain only these.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         question, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         response)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">OCD</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">ad;oi98732paisdh</td>
</tr>
<tr class="odd">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
</tr>
<tr class="even">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
</tr>
<tr class="even">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">1023984cao982738</td>
</tr>
<tr class="odd">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
</tr>
<tr class="even">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="odd">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">GAD</td>
</tr>
<tr class="even">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">2982879q8w7r</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>What code would you write to select the ‘date’ and ‘correct’ columns?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         correct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>What code would you write to print all the columns present in ‘dat_demographics_renamed’ in a way you can easily paste into a <code>select()</code> call? This was covered in <a href="../chapters/the_pipe_and_renaming.html">the previous chapter</a>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>c("date", "id", "build", "block_trial", "question", "response", 
"correct", "rt")</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="positive-vs.-negative-selections" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="positive-vs.-negative-selections"><span class="header-section-number">6.1.1</span> Positive vs.&nbsp;negative selections</h3>
<p>The above example tells <code>select()</code> the columns to retain. You could instead tell it which ones to drop. This is a negative selection: you preface the column name with <code>-</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>build, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>block_trial, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>correct, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>rt)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">OCD</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">ad;oi98732paisdh</td>
</tr>
<tr class="odd">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
</tr>
<tr class="even">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
</tr>
<tr class="even">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">1023984cao982738</td>
</tr>
<tr class="odd">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
</tr>
<tr class="even">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="odd">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">GAD</td>
</tr>
<tr class="even">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">2982879q8w7r</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It’s tempting to think in terms of negative selections, i.e., getting rid of columns you don’t want. However, you should in general use positive selections and avoid negative ones. If the underlying data changes in some way, e.g., in a prior processing step, it can contain variables your negative selection doesn’t account for. For example, if ‘dat_demographics_renamed’ now included another column, “completed_study” (TRUE/FALSE), the positive selection would not include this variable as it wasn’t listed, but the negative selection would as it was not specifically excluded. This can produce code that is more ‘fragile’ to changes in the data.</p>
<p>In general, tell select what you <em>do want</em>, not what you <em>don’t want</em>.</p>
<p>Check your understanding of positive and negative selections: What would happen if you mix positive and negative selections?</p>
<ol type="1">
<li>What columns will be present in the output when your run the code below?</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         question, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         response,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>correct)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<p>Why are those columns present and not others?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Once positive selections are present in the select call, the negative ones are redundant. You’ve already told <code>select()</code> what to include, which implies what not to include.</p>
</div>
</div>
</div>
</section>
<section id="tidyselect-helper-functions" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="tidyselect-helper-functions"><span class="header-section-number">6.1.2</span> {tidyselect} helper functions</h3>
<p>Often, we have large datasets with many columns. <code>select()</code> calls can be made simpler with the help of another {tidyverse} package, {tidyselect}.</p>
<p>To illustrate this, we’ll use a simulated dataset called ‘dat_many_columns’ that contains, you guessed it, many columns.</p>
<p>Let’s start by printing the column names:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>c("id", "age", "gender", "condition", "depression_scale1_item1", 
"depression_scale1_item2", "depression_scale1_item3", "depression_scale1_item4", 
"depression_scale1_item5", "depression_scale1_item6", "depression_scale1_item7", 
"depression_scale1_item8", "depression_scale1_item9", "depression_scale1_item10", 
"depression_scale2_item1", "depression_scale2_item2", "depression_scale2_item3", 
"depression_scale2_item4", "depression_scale2_item5", "depression_scale2_item6", 
"depression_scale2_item7", "depression_scale3_item1", "depression_scale3_item2", 
"depression_scale3_item3", "depression_scale3_item4", "depression_scale3_item5", 
"depression_scale3_item6", "depression_scale3_item7", "depression_scale3_item8", 
"depression_scale3_item9", "depression_scale3_item10", "depression_scale3_item11", 
"depression_scale3_item12", "depression_scale3_item13", "depression_scale3_item14", 
"depression_scale3_item15")</code></pre>
</div>
</div>
<section id="exercise" class="level4" data-number="6.1.2.1">
<h4 data-number="6.1.2.1" class="anchored" data-anchor-id="exercise"><span class="header-section-number">6.1.2.1</span> Exercise</h4>
<p>Write code to:</p>
<ol type="1">
<li>Create a new data frame called ‘dat_fewer_columns’</li>
<li><code>select()</code> all the columns beginning with “depression”, using only positive selections</li>
<li>Print the column names to confirm that these are the only ones present</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(depression_scale1_item1, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item2, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item3, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item4, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item5, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item6, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item7, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item8, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item9, </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item10, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item1, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item2, </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item3, </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item4, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item5, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item6, </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item7, </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item1, </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item2, </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item3, </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item4, </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item5, </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item6, </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item7, </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item8, </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item9, </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item10, </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item11, </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item12, </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item13, </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item14, </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item15)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>c("depression_scale1_item1", "depression_scale1_item2", "depression_scale1_item3", 
"depression_scale1_item4", "depression_scale1_item5", "depression_scale1_item6", 
"depression_scale1_item7", "depression_scale1_item8", "depression_scale1_item9", 
"depression_scale1_item10", "depression_scale2_item1", "depression_scale2_item2", 
"depression_scale2_item3", "depression_scale2_item4", "depression_scale2_item5", 
"depression_scale2_item6", "depression_scale2_item7", "depression_scale3_item1", 
"depression_scale3_item2", "depression_scale3_item3", "depression_scale3_item4", 
"depression_scale3_item5", "depression_scale3_item6", "depression_scale3_item7", 
"depression_scale3_item8", "depression_scale3_item9", "depression_scale3_item10", 
"depression_scale3_item11", "depression_scale3_item12", "depression_scale3_item13", 
"depression_scale3_item14", "depression_scale3_item15")</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>This can be done more easily with <code>tidyselect::starts_with()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyselect)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"depression"</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>c("depression_scale1_item1", "depression_scale1_item2", "depression_scale1_item3", 
"depression_scale1_item4", "depression_scale1_item5", "depression_scale1_item6", 
"depression_scale1_item7", "depression_scale1_item8", "depression_scale1_item9", 
"depression_scale1_item10", "depression_scale2_item1", "depression_scale2_item2", 
"depression_scale2_item3", "depression_scale2_item4", "depression_scale2_item5", 
"depression_scale2_item6", "depression_scale2_item7", "depression_scale3_item1", 
"depression_scale3_item2", "depression_scale3_item3", "depression_scale3_item4", 
"depression_scale3_item5", "depression_scale3_item6", "depression_scale3_item7", 
"depression_scale3_item8", "depression_scale3_item9", "depression_scale3_item10", 
"depression_scale3_item11", "depression_scale3_item12", "depression_scale3_item13", 
"depression_scale3_item14", "depression_scale3_item15")</code></pre>
</div>
</div>
<p>There are many other {tidyselect} helper functions including:</p>
<ul>
<li><code>starts_with()</code> : Selects columns ending in a character string</li>
<li><code>ends_with()</code> : Selects columns ending in a character string</li>
<li><code>contains()</code> : Selects columns containing a character string, not necessarily at the start or end</li>
<li><code>all_of()</code> : Selects all of the column names in a vector e.g., <code>all_of(c("a", "b"))</code></li>
<li><code>any_of()</code> : Selects any of the column names in a vector that are present, silently dropping missing ones. This can be very useful when columns may or may not be present, but has the risk of creating silent errors.</li>
<li><code>where()</code> : Select columns that meet a criterion, e.g., <code>where(is.numeric)</code> selects only columns containing numeric data.</li>
<li><code>everything()</code> : Selects all columns. This will seem redundant right now, but will become useful later on when we cover <code>pivot_</code> functions</li>
</ul>
</section>
<section id="exercise-1" class="level4" data-number="6.1.2.2">
<h4 data-number="6.1.2.2" class="anchored" data-anchor-id="exercise-1"><span class="header-section-number">6.1.2.2</span> Exercise</h4>
<p>Write code to select all columns for scale 2 from the ‘dat_many_columns’ data frame.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"scale2"</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>c("depression_scale2_item1", "depression_scale2_item2", "depression_scale2_item3", 
"depression_scale2_item4", "depression_scale2_item5", "depression_scale2_item6", 
"depression_scale2_item7")</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercise-2" class="level4" data-number="6.1.2.3">
<h4 data-number="6.1.2.3" class="anchored" data-anchor-id="exercise-2"><span class="header-section-number">6.1.2.3</span> Exercise</h4>
<p>Write code to select from the ‘dat_many_columns’ data frame the “id”, “age” and “gender” columns AND all columns related to item3.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, gender, <span class="fu">contains</span>(<span class="st">"item3"</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>c("id", "age", "gender", "depression_scale1_item3", "depression_scale2_item3", 
"depression_scale3_item3")</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercise-3" class="level4" data-number="6.1.2.4">
<h4 data-number="6.1.2.4" class="anchored" data-anchor-id="exercise-3"><span class="header-section-number">6.1.2.4</span> Exercise</h4>
<p>Write code to select the “id”, “age” and “gender” columns AND all columns related to item1.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, gender, <span class="fu">ends_with</span>(<span class="st">"item1"</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>c("id", "age", "gender", "depression_scale1_item1", "depression_scale2_item1", 
"depression_scale3_item1")</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="selection-with-set-operations" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="selection-with-set-operations"><span class="header-section-number">6.1.3</span> Selection with set operations</h3>
<p>Negative selection using <code>-</code> is selection using a “set operation” or a set of logical rules that determine which column names are in the selected set. There are others:</p>
<ul>
<li>Set operations:
<ul>
<li><code>-</code> negative selection</li>
<li><code>c()</code> : combine selections</li>
<li><code>!</code> invert selection</li>
<li><code>&amp;</code> must meet both selection rules</li>
<li><code>|</code> can meet either selection criteria</li>
</ul></li>
</ul>
<p>For example: select columns that refer to scale 3 AND items &gt;=10:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, gender, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>         <span class="co"># items containing scale3 AND item1 but NOT item 1</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="fu">contains</span>(<span class="st">"scale3"</span>) <span class="sc">&amp;</span> <span class="fu">contains</span>(<span class="st">"item1"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">ends_with</span>(<span class="st">"item1"</span>)))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>c("id", "age", "gender", "depression_scale3_item10", "depression_scale3_item11", 
"depression_scale3_item12", "depression_scale3_item13", "depression_scale3_item14", 
"depression_scale3_item15")</code></pre>
</div>
</div>
<section id="exercise-4" class="level4" data-number="6.1.3.1">
<h4 data-number="6.1.3.1" class="anchored" data-anchor-id="exercise-4"><span class="header-section-number">6.1.3.1</span> Exercise</h4>
<p>To practice {tidyselect} helpers and selection set operations, write code in a creative and unnecessarily complex way to select the columns “id”, “gender”, and “age”, and the items from scale 1 and scale 3 that whose items are &lt;= 10.</p>
<p>Note: no solution provided here as many different ones are possible.</p>
</section>
</section>
<section id="practicing-select-and-the-pipe-in-a-longer-chunk" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="practicing-select-and-the-pipe-in-a-longer-chunk"><span class="header-section-number">6.1.4</span> Practicing select and the pipe in a longer chunk</h3>
<section id="exercise-5" class="level4" data-number="6.1.4.1">
<h4 data-number="6.1.4.1" class="anchored" data-anchor-id="exercise-5"><span class="header-section-number">6.1.4.1</span> Exercise</h4>
<p>The first chunk in this chapter read in the ‘data_demographics_raw_messy.csv’ file and renamed columns.</p>
<ul>
<li>Rewrite that chunk here - as much as possible from memory, without simply copy pasting.</li>
<li>Add another pipe and selecting the “id”, “question” and “response” columns.</li>
<li>Print a table of the resulting data frame using <code>kable()</code> and <code>kable_class()</code></li>
</ul>
<p>Note: no solution provided here to reduce the temptation to peek or copy-paste.</p>
</section>
</section>
</section>
<section id="moving-columns-with-dplyrrelocate" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="moving-columns-with-dplyrrelocate"><span class="header-section-number">6.2</span> Moving columns with <code>dplyr::relocate()</code></h2>
<p>You can reorder to columns within a data frame with <code>relocate()</code>.</p>
<p>Unlike <code>rename()</code>, <code>select()</code>, and other functions, only one column can be relocated with each <code>relocate()</code> call.</p>
<p>You can relocate columns before or after others, or to locations such as being the first or last column. This code moves the “response” column to be before the “question” column, and the “correct” column to be the last one.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(response, <span class="at">.before =</span> <span class="st">"question"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(correct, <span class="at">.after =</span> <span class="fu">last_col</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">age</td>
<td style="text-align: right;">1372</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">619</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: right;">1372</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: right;">619</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">48</td>
<td style="text-align: left;">age</td>
<td style="text-align: right;">3946</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">3724</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="exercise-6" class="level4" data-number="6.2.0.1">
<h4 data-number="6.2.0.1" class="anchored" data-anchor-id="exercise-6"><span class="header-section-number">6.2.0.1</span> Exercise</h4>
<p>What code is needed to relocate the columns of ‘dat_demographics_renamed’ so that they are in the order “id”, “question”, “response”, and then the remaining columns.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_reordered <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(question, <span class="at">.after =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(response, <span class="at">.after =</span> <span class="st">"question"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>dat_demographics_reordered <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercise-7" class="level4" data-number="6.2.0.2">
<h4 data-number="6.2.0.2" class="anchored" data-anchor-id="exercise-7"><span class="header-section-number">6.2.0.2</span> Exercise</h4>
<p>All three of the solutions below accomplish the goal of making the “id” column the first column:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># move "id" to be the first column by placing it before "date"</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> <span class="st">"date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># move "date" to be the second column by placing it after "id", producing the same result</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(date, <span class="at">.after =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># move "id" to be the 1st column by placing it before the first column by location, producing the same result</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br> Which of the above solutions is the least ‘fragile’ solution, i.e., that is robust to changes in the data or elsewhere in your data processing code?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>relocate(id, .before = 1)</code> does not rely on the name and location of another column and is therefore the least fragile solution.</p>
</div>
</div>
</div>
</section>
</section>
<section id="renaming-relocating-and-selecting-all-in-one-with-select" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="renaming-relocating-and-selecting-all-in-one-with-select"><span class="header-section-number">6.3</span> Renaming, relocating, and selecting all-in-one with <code>select()</code></h2>
<p>Renaming, relocating, and selecting columns are so common as a set of three tasks that you can do it all within <code>select()</code>.</p>
<p>Whatever order columns appear in <code>select()</code> they will be relocated to. You can rename variables inside select just as you do in <code>rename()</code> using <code>new_name = old_name</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, date, question, <span class="at">answer =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">answer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
</tr>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
</tr>
<tr class="even">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
</tr>
<tr class="odd">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="keeping-or-dropping-rows-with-dplyrfilter" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="keeping-or-dropping-rows-with-dplyrfilter"><span class="header-section-number">6.4</span> Keeping or dropping rows with <code>dplyr::filter()</code></h2>
<p>Not all rows in a dataset are useful to us. When processing data, we often wish to keep only some rows and drop others. We can do this with <code>dplyr::filter()</code>.</p>
<p>It is important to learn the difference between <code>select()</code> and <code>filter()</code>, it is initially confusing.</p>
<ul>
<li><code>select()</code> keeps or drops <strong>columns</strong></li>
<li><code>filter()</code> keeps or drops <strong>rows</strong></li>
</ul>
<p>For example, filter the ‘question’ column to contain only “age” items:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dat_filtered_age <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"age"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>dat_filtered_age <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4311</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="exercise-8" class="level4" data-number="6.4.0.1">
<h4 data-number="6.4.0.1" class="anchored" data-anchor-id="exercise-8"><span class="header-section-number">6.4.0.1</span> Exercise</h4>
<p>Write code to:</p>
<ul>
<li>Take the ‘dat_demographics_renamed’ data frame.</li>
<li>Create two data frames called ‘dat_filtered_age’ and ‘dat_filtered_gender’.</li>
<li>Retain only the relevant rows of ‘question’ for each.</li>
<li>Rename the ‘response’ columns to what variable it now contains.</li>
<li>Drop the ‘question’ columns since they’re now irrelevant.</li>
<li>Print a table of each data frame.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dat_filtered_age <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">age =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>question)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>dat_filtered_age <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">999</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4311</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"gender"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gender =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>question)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2793</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="filters-with-set-operations" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="filters-with-set-operations"><span class="header-section-number">6.4.1</span> Filters with set operations</h3>
<p>You can specify the logical test for filtering in many ways, including:</p>
<ul>
<li><code>==</code> : ‘is exactly equal to this one value’</li>
<li><code>!=</code> : ’is not exactly equal to</li>
<li><code>%in%</code> : ‘is exactly equal to one of the following values’</li>
</ul>
<p>Note that equivalence is two equals signs (<code>==</code>) whereas setting arguments in functions is one (<code>=</code>).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># '==' exactly equal to</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"female"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># '!=' is not exactly equal to</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"female"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># '%in%' is exactly equal to one of the following</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Weirdly, there is no single function that provides the combination of <code>%in%</code> and <code>!=</code>, i.e., ‘is not exactly equal to any of the following values’. This can be achieved with the following, although it is not intuitive:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># '!' and '%in%'</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2793</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>You can also combine multiple tests with various operators:</p>
<ul>
<li><code>&amp;</code> : AND, i.e., meeting both criterion.</li>
<li><code>|</code> : OR, i.e., meeting either criterion.</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &amp; criterion X and Y</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"gender"</span> <span class="sc">&amp;</span> response <span class="sc">==</span> <span class="st">"female"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># | criterion X or Y</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"gender"</span> <span class="sc">|</span> response <span class="sc">==</span> <span class="st">"female"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2793</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="exercise-9" class="level4" data-number="6.4.1.1">
<h4 data-number="6.4.1.1" class="anchored" data-anchor-id="exercise-9"><span class="header-section-number">6.4.1.1</span> Exercise</h4>
<p>Write code to:</p>
<ul>
<li>Take the ‘dat_demographics_renamed’ data frame.</li>
<li>Create the data frame ‘dat_filtered_rt’.</li>
<li>Retain only rows where where reaction time (‘re’) is more than 500 ms.</li>
<li>Print a table of each data frame.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dat_filtered_rt <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rt <span class="sc">&gt;</span> <span class="dv">500</span>) </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>dat_filtered_rt <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">OCD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">ad;oi98732paisdh</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">1023984cao982738</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4311</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">GAD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6887</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">2982879q8w7r</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6887</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercise-10" class="level4" data-number="6.4.1.2">
<h4 data-number="6.4.1.2" class="anchored" data-anchor-id="exercise-10"><span class="header-section-number">6.4.1.2</span> Exercise</h4>
<p>Write code to:</p>
<ul>
<li>Take the ‘dat_demographics_renamed’ data frame.</li>
<li>Create the data frame ‘dat_filtered_rt’.</li>
<li>Retain only rows where where both reaction time (‘rt’) is more than 500 ms and gender is either ‘male’, ‘female’, or ‘non-binary’.</li>
<li>Print a table of each data frame.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dat_filtered_rt <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rt <span class="sc">&gt;</span> <span class="dv">500</span> <span class="sc">&amp;</span> question <span class="sc">==</span> <span class="st">'gender'</span> <span class="sc">&amp;</span> response <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'non-binary'</span>)) </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>dat_filtered_rt <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercise-11" class="level4" data-number="6.4.1.3">
<h4 data-number="6.4.1.3" class="anchored" data-anchor-id="exercise-11"><span class="header-section-number">6.4.1.3</span> Exercise</h4>
<p>In the above answer, why might it be a good idea to include <code>question == 'gender'</code>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Because the requirement was “…and gender is either ‘male’, ‘female’, or ‘non-binary’”.</p>
<p>If participants responded to another question (e.g., ‘age’) with ‘male’, ‘female’, or ‘non-binary’, their rows would also be returned.</p>
<p>Being specific to the requirements makes your code less ‘brittle’ and more likely to catch weird cases in larger datasets.</p>
</div>
</div>
</div>
</section>
</section>
<section id="positive-vs.-negative-filters" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="positive-vs.-negative-filters"><span class="header-section-number">6.4.2</span> Positive vs.&nbsp;negative filters</h3>
<p>As with <code>select()</code>, it is often better to define what you <em>do</em> want (<code>==</code> and <code>%&gt;%</code>) rather than what you <em>do not</em> want (<code>!=</code> and <code>!</code>+<code>%in%</code>). This is even more important with <code>filter()</code> as unexpected row values are much more common than unexpected column names.</p>
<p>For example, if you specify a negative filter <code>dat %&gt;% filter(gender != "non-binary)"</code> because you wish to filter to return only participants who identify as ‘male’ or ‘female’, you have in fact only excluded participants who specified ‘non-binary’. This code would also return participants with other response options such as ‘non binary’, ‘Non-Binary’, ‘NB’, etc.</p>
<p>However, there can be cases where you specifically do not want some rows or want to retain anything other than a given value. Protecting participant privacy is one of them.</p>
<p>Some rows of the ‘dat_demographics_renamed’ data frame contain “prolific ID” values, which could be linked back to the individual’s Prolific.com account where they completed the study, and therefore risk exposing identifying information. If this data was shared with other researchers or publicly, this could violate the informed consent agreement and/or local data privacy laws. (Note that the prolific IDs included in this data frame are made up.) This is discussed in more detail in the chapter on <a href="../chapters/privacy.html">Data Privacy</a>.</p>
<p>In this case, you would likely need to remove all rows referring to Prolific ID with a negative filter:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_anonymized <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">!=</span> <span class="st">"prolific ID"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>dat_demographics_anonymized <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">OCD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4311</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2793</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">GAD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6887</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that the original ‘data_demographics_raw_messy.csv’ data file we originally read in to R still contains the Prolific ID codes! Again, see the <a href="../chapters/privacy.html">Data Privacy</a> chapter for how you would deal with this more thoroughly in your own projects.</p>
</section>
</section>
<section id="creating-and-modifying-columns-with-dplyrmutate" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="creating-and-modifying-columns-with-dplyrmutate"><span class="header-section-number">6.5</span> Creating and modifying columns with <code>dplyr::mutate()</code></h2>
<p><code>mutate()</code> is used to create new columns or to change the contents of existing ones.</p>
<p>For example, we can create the ‘rt_seconds’ column by dividing the ‘rt’ column, which is in milliseconds, by 1000.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_seconds =</span> rt<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt_seconds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
<td style="text-align: right;">1.372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
<td style="text-align: right;">0.619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1372</td>
<td style="text-align: right;">1.372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">619</td>
<td style="text-align: right;">0.619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
<td style="text-align: right;">3.946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
<td style="text-align: right;">3.724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">OCD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3946</td>
<td style="text-align: right;">3.946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">ad;oi98732paisdh</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3724</td>
<td style="text-align: right;">3.724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
<td style="text-align: right;">2.576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
<td style="text-align: right;">3.050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2576</td>
<td style="text-align: right;">2.576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">1023984cao982738</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3050</td>
<td style="text-align: right;">3.050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4311</td>
<td style="text-align: right;">4.311</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2793</td>
<td style="text-align: right;">2.793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">GAD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6887</td>
<td style="text-align: right;">6.887</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">2982879q8w7r</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6887</td>
<td style="text-align: right;">6.887</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can also alter existing columns through self-assignment, i.e., <code>mutate()</code>-ing a column based on itself. For example, modifying ‘rt’ to be in seconds by overwriting the existing ‘rt’ column:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt =</span> rt<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">OCD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">ad;oi98732paisdh</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">1023984cao982738</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.311</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">GAD</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.887</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">2982879q8w7r</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.887</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can also change types, for example, converting the ‘correct’ column from numeric (0/1) to logical (TRUE/FALSE).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">correct =</span> <span class="fu">as.logical</span>(correct))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">build</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">block_trial</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">question</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">correct</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">23</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">1372</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">asldkjaao87809</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">619</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">48</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">OCD</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">3946</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">ad;oi98732paisdh</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">3724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">21</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">female</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">schizophrenia</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">2576</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">1023984cao982738</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">3050</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">999</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">4311</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_3</td>
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">2793</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">psychiatric diagnosis</td>
<td style="text-align: left;">GAD</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">6887</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.06.2022</td>
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">06.06.2000</td>
<td style="text-align: left;">demographics_2</td>
<td style="text-align: left;">prolific ID</td>
<td style="text-align: left;">2982879q8w7r</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">6887</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="longer-pipes" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="longer-pipes"><span class="header-section-number">6.5.1</span> Longer pipes</h3>
<p>A single mutate call can contain multiple mutates. The code from the last chunk could be written more simply like this:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select only columns of interest</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, question, response, rt, correct) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter only rows of interest</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename columns to make them more intuitive</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">age =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate variables</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_ms =</span> rt<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">correct =</span> <span class="fu">as.logical</span>(correct)) <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select needed columns again</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, rt_ms, correct)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt_ms</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">correct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">23</td>
<td style="text-align: right;">1.372</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">48</td>
<td style="text-align: right;">3.946</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">21</td>
<td style="text-align: right;">2.576</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">999</td>
<td style="text-align: right;">4.311</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="exercise-12" class="level4" data-number="6.5.1.1">
<h4 data-number="6.5.1.1" class="anchored" data-anchor-id="exercise-12"><span class="header-section-number">6.5.1.1</span> Exercise</h4>
<p>Write code to:</p>
<ul>
<li>Take the ‘dat_demographics_renamed’.</li>
<li>Create a data frame named ‘dat_demographics_mutated’.</li>
<li>Retain only the gender question rows.</li>
<li>Rename ‘response’ to ‘gender’.</li>
<li>Use the <code>stringr::str_to_lower()</code> function to convert ‘gender’ to lower case strings’.</li>
<li>Retain only the id and gender columns.</li>
<li>Print the data frame.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">'gender'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gender =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, gender)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">548957868</td>
<td style="text-align: left;">female</td>
</tr>
<tr class="even">
<td style="text-align: right;">504546409</td>
<td style="text-align: left;">yes</td>
</tr>
<tr class="odd">
<td style="text-align: right;">994692692</td>
<td style="text-align: left;">female</td>
</tr>
<tr class="even">
<td style="text-align: right;">246532124</td>
<td style="text-align: left;">male</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="more-complex-mutates" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="more-complex-mutates"><span class="header-section-number">6.5.2</span> More complex mutates</h3>
<p>Most research reports (theses, articles, etc.) report the percentage of the sample that was male, female, etc. For example, the ‘dat_demographics_messy’ contains messy age and gender data for 500 participants.</p>
<p>We’ll use <code>count()</code> to show every unique response across participants. We’ll return to learn to use <code>count()</code> properly in the next chapter. For the moment, we’re more interested in the output than the code.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find unique values of 'gender' and the frequency of each</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange these unique cases by descending frequency</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print table</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">297</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nonbinary</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FEMALE</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">femail</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">27</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">30</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">43</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">45</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">fem ale</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">femle</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">malee</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">26</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">38</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">40</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MalE</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">femlae</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mal</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">19</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">22</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">31</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">36</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">41</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">42</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FeMale</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ma le</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">non binary</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note how the data currently contains many misspellings and use of different cases that cause things like ‘female’ to appear as a different category to ‘Female’, etc.</p>
<section id="mutate-and-working-with-character-strings" class="level4" data-number="6.5.2.1">
<h4 data-number="6.5.2.1" class="anchored" data-anchor-id="mutate-and-working-with-character-strings"><span class="header-section-number">6.5.2.1</span> <code>mutate()</code> and working with character strings</h4>
<p>Working with character strings using {stringr} and ‘regular expressions’ (regex) is a large separate topic in itself.</p>
<p>For the moment, know that you can:</p>
<ul>
<li>Use functions like <code>str_to_lower()</code> to convert all text to lower case (as in the above example).</li>
<li>Use <code>str_remove_all()</code> to remove everything except letters (<code>str_remove_all(x, "[^A-Za-z]")</code>) or everything except numbers (<code>str_remove_all(x, "[^0-9\\.]")</code>).</li>
</ul>
<p>Above, you used {stringr}’s <code>str_to_lower()</code> function to convert all letters to lower case. Let’s apply that here to quickly improve things:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to lower case</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">str_to_lower</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find unique values of 'gender' and the frequency of each</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange these unique cases by descending frequency</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print table</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">311</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">125</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nonbinary</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">femail</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">27</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">30</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">43</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">45</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">fem ale</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">femle</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">malee</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">26</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">38</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">40</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">femlae</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mal</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">19</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">22</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">23</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">31</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">36</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">41</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">42</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ma le</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">non binary</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Next we’ll use <code>str_remove_all(x, "[^A-Za-z]")</code> to remove everything except letters:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert to lower case</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">str_to_lower</span>(gender),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove all non-letters</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">str_remove_all</span>(gender, <span class="st">"[^A-Za-z]"</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find unique values of 'gender' and the frequency of each</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange these unique cases by descending frequency</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print table</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">314</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">126</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">nonbinary</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">femail</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">femle</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">malee</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">femlae</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mal</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="mutate-and-conditionals-rules" class="level4" data-number="6.5.2.2">
<h4 data-number="6.5.2.2" class="anchored" data-anchor-id="mutate-and-conditionals-rules"><span class="header-section-number">6.5.2.2</span> <code>mutate()</code> and conditionals rules</h4>
<section id="using-dplyrif_else" class="level5" data-number="6.5.2.2.1">
<h5 data-number="6.5.2.2.1" class="anchored" data-anchor-id="using-dplyrif_else"><span class="header-section-number">6.5.2.2.1</span> Using <code>dplyr::if_else()</code></h5>
<p>If we were being somewhat lazy, we could keep just the three most common self-reported responses to the gender, i.e.&nbsp;‘male’, ‘female’ and ‘non-binary’, and change the other responses to <code>NA</code>.</p>
<p>Many forms of data cleaning or ‘wrangling’ involve applying conditional rules like this to clean up irregular responses, i.e., “if gender is not ‘male’, ‘female’ or ‘non-binary’, then set it to <code>NA</code>”.</p>
<p>The simplest of these is <code>dplyr::if_else()</code>, which applies just one if-else. Note that there is a similar function in Base-R, <code>ifelse()</code>, but for technical reasons this function is much less safe and can cause weird errors. Try to always use <code>if_else()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>dat_gender_tidier <span class="ot">&lt;-</span> dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to lower case and remove non-letters</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">str_to_lower</span>(gender),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> <span class="fu">str_remove_all</span>(gender, <span class="st">"[^A-Za-z]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy up cases</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">if_else</span>(<span class="at">condition =</span> gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"nonbinary"</span>), <span class="co"># the logical test applied: is 'gender' one of the following</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">true =</span> gender, <span class="co"># what to do if the test is passed: keep the original gender response</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">false =</span> <span class="cn">NA_character_</span>)) <span class="co"># what to do if the test is failed: set it to NA</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>dat_gender_tidier <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">314</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">126</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">44</td>
</tr>
<tr class="even">
<td style="text-align: left;">nonbinary</td>
<td style="text-align: right;">16</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This somewhat quick and dirty solution gives us just four gender categories, ‘male’, ‘female’, ‘non-binary’ and missing (<code>NA</code>).</p>
<p>Of course, these responses were (mostly) not <em>really</em> missing, we removed them to make the responses simpler. This isn’t very good practice, as we’re throwing away data.</p>
</section>
<section id="using-dplyrcase_when" class="level5" data-number="6.5.2.2.2">
<h5 data-number="6.5.2.2.2" class="anchored" data-anchor-id="using-dplyrcase_when"><span class="header-section-number">6.5.2.2.2</span> Using <code>dplyr::case_when()</code></h5>
<p><code>case_when()</code> allows you to check against multiple logical tests. It works like this:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create the variable variable_to_create based on:</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_to_create =</span> <span class="fu">case_when</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if logical_test_1 is met, set variable_to_create to value_1</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    logical_test_1 <span class="sc">~</span> value_1, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if logical_test_2 is met, set variable_to_create to value_2</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    logical_test_2 <span class="sc">~</span> value_2, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if logical_test_3 is met, set variable_to_create to value_3</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    logical_test_3 <span class="sc">~</span> value_3, </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 'if none of the above are met, set to the default value value_4'</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> value_4</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that the logical tests are checked in order, so you often have to consider the order in which they are listed and run.</p>
<p>We can apply it like this:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dat_gender_tidier <span class="ot">&lt;-</span> dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to lower case and remove non-letters</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">str_to_lower</span>(gender),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> <span class="fu">str_remove_all</span>(gender, <span class="st">"[^A-Za-z]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy up cases</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">case_when</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"nonbinary"</span>) <span class="sc">~</span> gender, </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                            gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"femail"</span>, <span class="st">"fem ale"</span>, <span class="st">"femle"</span>, <span class="st">"femlae"</span>) <span class="sc">~</span> <span class="st">"female"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                            gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"malee"</span>, <span class="st">"mal"</span>, <span class="st">"ma le"</span>) <span class="sc">~</span> <span class="st">"male"</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                            gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"non binary"</span>, <span class="st">"nonbinary"</span>) <span class="sc">~</span> <span class="st">"non-binary"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                            gender <span class="sc">==</span> <span class="st">""</span> <span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="co"># if an empty character string, change to NA_character_</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> gender)) <span class="co"># if none of the above apply, keep original value</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>dat_gender_tidier <span class="sc">%&gt;%</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">gender</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">323</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">131</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">nonbinary</td>
<td style="text-align: right;">16</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Note that the contents of the <code>case_when()</code> conditions have to be constructed iteratively. Use <code>distinct()</code> to inspect what cases are present, then write code to merge them as desired.</p>
</section>
</section>
</section>
</section>
<section id="exercises" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="exercises"><span class="header-section-number">6.6</span> Exercises</h2>
<section id="select-vs.-filter" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="select-vs.-filter"><span class="header-section-number">6.6.1</span> <code>select()</code> vs.&nbsp;<code>filter()</code></h3>
<p>What is the difference between select and filter?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>select()</code> is for columns, <code>filter()</code> is for rows.</p>
</div>
</div>
</div>
</section>
<section id="tidyselect-helper-functions-1" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="tidyselect-helper-functions-1"><span class="header-section-number">6.6.2</span> {tidyselect} helper functions</h3>
<p>Name some helper functions from {tidyselect}.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><code>starts_with()</code></li>
<li><code>ends_with()</code></li>
<li><code>contains()</code></li>
<li><code>all_of()</code></li>
<li><code>any_of()</code></li>
<li><code>where()</code></li>
<li><code>everything()</code></li>
</ul>
</div>
</div>
</div>
<p>Explain what each of them do.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><code>starts_with()</code> : Selects columns ending in a character string</li>
<li><code>ends_with()</code> : Selects columns ending in a character string</li>
<li><code>contains()</code> : Selects columns containing a character string, not necessarily at the start or end</li>
<li><code>all_of()</code> : Selects all of the column names in a vector e.g., <code>all_of(c("a", "b"))</code></li>
<li><code>any_of()</code> : Selects any of the column names in a vector that are present, silently dropping missing ones. This can be very useful when columns may or may not be present, but has the risk of creating silent errors.</li>
<li><code>where()</code> : Select columns that meet a criterion, e.g., <code>where(is.numeric)</code> selects only columns containing numeric data.</li>
<li><code>everything()</code> : Selects all columns.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="positive-vs.-negative-selections-and-filters" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="positive-vs.-negative-selections-and-filters"><span class="header-section-number">6.6.3</span> Positive vs.&nbsp;negative selections and filters</h3>
<p>Explain the difference between positive and negative selections in <code>select()</code> and <code>filter()</code> and how they are done in each.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>In <code>select()</code>, positive selections mean <em>keep</em> these columns (e.g., <code>select(mpg, cyl)</code>), while negative selections mean <em>drop</em> these columns (e.g., <code>select(-mpg, -cyl)</code>).</li>
<li>In <code>filter()</code>, conditions act positively by default (e.g., <code>filter(mpg &gt; 20)</code> keeps rows with mpg &gt; 20). To “negate” a condition, you use <code>!</code> or inequality operators (e.g., <code>filter(!(mpg &gt; 20))</code> or <code>filter(mpg &lt;= 20)</code>).</li>
</ul>
</div>
</div>
</div>
</section>
<section id="set-operators" class="level3" data-number="6.6.4">
<h3 data-number="6.6.4" class="anchored" data-anchor-id="set-operators"><span class="header-section-number">6.6.4</span> Set operators</h3>
<p>What set operators can be used with <code>select()</code> and how?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>select()</code> supports set operations on columns using tidyselect helpers:</p>
<ul>
<li><code>-</code> : negative selection (drop columns)<br>
</li>
<li><code>c()</code> : combine multiple selections (union)<br>
</li>
<li><code>!</code> : invert a selection rule<br>
</li>
<li><code>&amp;</code> : must meet <em>both</em> selection rules (intersection)<br>
</li>
<li><code>|</code> : can meet <em>either</em> selection rule (union)</li>
</ul>
<p>Example:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(dat, <span class="fu">contains</span>(<span class="st">"scale3"</span>) <span class="sc">&amp;</span> <span class="fu">contains</span>(<span class="st">"item1"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">ends_with</span>(<span class="st">"item1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>What set operators can be used with <code>filter()</code> and how?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Click to show answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to show answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>With filter(), set operations are expressed with logical operators applied to rows:</p>
<ul>
<li><code>&amp;</code> : keeps rows that satisfy all conditions (intersection)</li>
<li><code>|</code> : keeps rows that satisfy any condition (union)</li>
<li><code>!</code> : excludes rows that meet a condition (negation/difference)</li>
</ul>
<p>Example:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"female"</span> <span class="sc">&amp;</span> age <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="interactive-exercises" class="level3" data-number="6.6.5">
<h3 data-number="6.6.5" class="anchored" data-anchor-id="interactive-exercises"><span class="header-section-number">6.6.5</span> Interactive exercises</h3>
<p>Complete the interactive exercises for:</p>
<ul>
<li><a href="https://errors.shinyapps.io/dplyr-learnr/#section-dplyrselect"><code>select()</code></a></li>
<li><a href="https://errors.shinyapps.io/dplyr-learnr/#section-dplyrrelocate"><code>relocate()</code></a></li>
<li><a href="https://errors.shinyapps.io/dplyr-learnr/#section-dplyrfilter"><code>filter()</code></a></li>
<li><a href="https://errors.shinyapps.io/dplyr-learnr/#section-dplyrmutate"><code>mutate()</code></a></li>
<li><a href="https://errors.shinyapps.io/dplyr-learnr/#section-dplyrcase_when"><code>case_when()</code></a></li>
</ul>
</section>
<section id="practice-data-transformation-using-multiple-functions" class="level3" data-number="6.6.6">
<h3 data-number="6.6.6" class="anchored" data-anchor-id="practice-data-transformation-using-multiple-functions"><span class="header-section-number">6.6.6</span> Practice data transformation using multiple functions</h3>
<p>In your local version of this .qmd file:</p>
<ul>
<li>Use the ‘dat_demographics_messy’ to create a new data frame called ‘dat_age_tidier’</li>
<li>Use <code>disinct()</code> to understand what unique responses are present in the ‘age’ column.</li>
<li>Use the other functions you learned in this chapter to clean the age column so that it contains only numbers.</li>
<li>Convert the age variable to a numeric variable with <code>as.numeric()</code>.</li>
<li>Print the unique responses present in the processed ‘age’ column as a table.</li>
</ul>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/the_pipe_and_renaming.html" class="pagination-link" aria-label="The pipe and renaming">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The pipe and renaming</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/data_transformation_2.html" class="pagination-link" aria-label="Data transformation II">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data transformation II</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb53" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Data transformation I" </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true </span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">    toc_float: true </span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show </span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true </span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># settings, placed in a chunk that will not show in the .html file (because include=FALSE) </span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># disables scientific notation so that small numbers appear as eg "0.00001" rather than "1e-05"</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)  </span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>The next few chapters cover various {tidyverse} functions - sometimes called verbs - that are used for data transformation.</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>This chapter covers functions that are "*non-aggregating*": they allow you to change which columns or rows are present in the dataset, to create new columns or split up existing ones, to change their contents, etc. <span class="in">`rename()`</span>, which you learned in the previous chapter, is one of these functions.</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Keeping or dropping columns with `dplyr::select()`</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>Not all columns in a dataset are useful to us. When processing data, we often wish to keep only some columns and drop others. We can do this with <span class="in">`dplyr::select()`</span>.</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>We'll start where the last chapter ended, by loading dependencies, reading in the 'data_demographics_raw_messy.csv' dataset, and renaming the columns to make them easier to work with.</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># for read_csv()</span></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="co"># for clean_names()</span></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># for %&gt;%</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># for kable()</span></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co"># for kable_extra()</span></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="ot">&lt;-</span> </span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"../data/raw/data_demographics_raw_messy.csv"</span>,</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> subject_code, </span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">block_trial =</span> block_code_and_trial_number, </span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">question =</span> trial_code, </span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>         <span class="at">response =</span> key_response_use_this, </span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">rt =</span> x0_ms_onset_rt)</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>If our data processing goal is to extract and tidy responses on the demographics questionnaire, we only need some of these columns: id, question, and response. We can use <span class="in">`select()`</span> and the pipe to retain only these.</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, </span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>         question, </span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>         response)</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="sc">%&gt;%</span></span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a>What code would you write to select the 'date' and 'correct' columns?</span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, </span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a>         correct)</span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a>What code would you write to print all the columns present in 'dat_demographics_renamed' in a way you can easily paste into a <span class="in">`select()`</span> call? This was covered in <span class="co">[</span><span class="ot">the previous chapter</span><span class="co">](the_pipe_and_renaming.qmd)</span>.</span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a><span class="fu">### Positive vs. negative selections</span></span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a>The above example tells <span class="in">`select()`</span> the columns to retain. You could instead tell it which ones to drop. This is a negative selection: you preface the column name with <span class="in">`-`</span>.</span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date, </span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>build, </span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>block_trial, </span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>correct, </span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>rt)</span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="sc">%&gt;%</span></span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a>It's tempting to think in terms of negative selections, i.e., getting rid of columns you don't want. However, you should in general use positive selections and avoid negative ones. If the underlying data changes in some way, e.g., in a prior processing step, it can contain variables your negative selection doesn't account for. For example, if 'dat_demographics_renamed' now included another column, "completed_study" (TRUE/FALSE), the positive selection would not include this variable as it wasn't listed, but the negative selection would as it was not specifically excluded. This can produce code that is more 'fragile' to changes in the data.</span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a>In general, tell select what you *do want*, not what you *don't want*.</span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a>Check your understanding of positive and negative selections: What would happen if you mix positive and negative selections?</span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>What columns will be present in the output when your run the code below?</span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, </span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a>         question, </span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a>         response,</span>
<span id="cb53-131"><a href="#cb53-131" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>correct)</span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="sc">%&gt;%</span></span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-138"><a href="#cb53-138" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-141"><a href="#cb53-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-142"><a href="#cb53-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-144"><a href="#cb53-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, </span>
<span id="cb53-145"><a href="#cb53-145" aria-hidden="true" tabindex="-1"></a>         question, </span>
<span id="cb53-146"><a href="#cb53-146" aria-hidden="true" tabindex="-1"></a>         response,</span>
<span id="cb53-147"><a href="#cb53-147" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>correct)</span>
<span id="cb53-148"><a href="#cb53-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-149"><a href="#cb53-149" aria-hidden="true" tabindex="-1"></a>dat_demographics_selected <span class="sc">%&gt;%</span></span>
<span id="cb53-150"><a href="#cb53-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-151"><a href="#cb53-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-152"><a href="#cb53-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-153"><a href="#cb53-153" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-154"><a href="#cb53-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-155"><a href="#cb53-155" aria-hidden="true" tabindex="-1"></a>Why are those columns present and not others?</span>
<span id="cb53-156"><a href="#cb53-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-157"><a href="#cb53-157" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-158"><a href="#cb53-158" aria-hidden="true" tabindex="-1"></a>Once positive selections are present in the select call, the negative ones are redundant. You've already told <span class="in">`select()`</span> what to include, which implies what not to include.</span>
<span id="cb53-159"><a href="#cb53-159" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-160"><a href="#cb53-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-161"><a href="#cb53-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### {tidyselect} helper functions</span></span>
<span id="cb53-162"><a href="#cb53-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-163"><a href="#cb53-163" aria-hidden="true" tabindex="-1"></a>Often, we have large datasets with many columns. <span class="in">`select()`</span> calls can be made simpler with the help of another {tidyverse} package, {tidyselect}.</span>
<span id="cb53-164"><a href="#cb53-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-165"><a href="#cb53-165" aria-hidden="true" tabindex="-1"></a>To illustrate this, we'll use a simulated dataset called 'dat_many_columns' that contains, you guessed it, many columns.</span>
<span id="cb53-166"><a href="#cb53-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-169"><a href="#cb53-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-170"><a href="#cb53-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false # don't show code in the ebook</span></span>
<span id="cb53-171"><a href="#cb53-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-172"><a href="#cb53-172" aria-hidden="true" tabindex="-1"></a><span class="co"># this block simulates a dataset with many columns using the {truffle} package</span></span>
<span id="cb53-173"><a href="#cb53-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-174"><a href="#cb53-174" aria-hidden="true" tabindex="-1"></a><span class="co"># install the packages devtools and truffles if not already installed </span></span>
<span id="cb53-175"><a href="#cb53-175" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"stringr"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb53-176"><a href="#cb53-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb53-177"><a href="#cb53-177" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-178"><a href="#cb53-178" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"devtools"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb53-179"><a href="#cb53-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb53-180"><a href="#cb53-180" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-181"><a href="#cb53-181" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"truffle"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb53-182"><a href="#cb53-182" aria-hidden="true" tabindex="-1"></a>  devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ianhussey/truffle"</span>)</span>
<span id="cb53-183"><a href="#cb53-183" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-184"><a href="#cb53-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-185"><a href="#cb53-185" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(truffle)</span>
<span id="cb53-186"><a href="#cb53-186" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb53-187"><a href="#cb53-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-188"><a href="#cb53-188" aria-hidden="true" tabindex="-1"></a>dat_many_columns <span class="ot">&lt;-</span></span>
<span id="cb53-189"><a href="#cb53-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">truffle_likert</span>(<span class="at">n_per_condition =</span> <span class="dv">5</span>,</span>
<span id="cb53-190"><a href="#cb53-190" aria-hidden="true" tabindex="-1"></a>                 <span class="at">factors  =</span> <span class="fu">c</span>(<span class="st">"X1_latent"</span>, <span class="st">"X2_latent"</span>, <span class="st">"X3_latent"</span>),</span>
<span id="cb53-191"><a href="#cb53-191" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prefixes =</span> <span class="fu">c</span>(<span class="st">"X1_item"</span>, <span class="st">"X2_item"</span>, <span class="st">"X3_item"</span>),</span>
<span id="cb53-192"><a href="#cb53-192" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fu">c</span>(.<span class="dv">70</span>, .<span class="dv">75</span>, .<span class="dv">80</span>),</span>
<span id="cb53-193"><a href="#cb53-193" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n_items =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">15</span>),</span>
<span id="cb53-194"><a href="#cb53-194" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n_levels =</span> <span class="dv">7</span>,</span>
<span id="cb53-195"><a href="#cb53-195" aria-hidden="true" tabindex="-1"></a>                 <span class="at">r_among_outcomes =</span> <span class="fl">0.50</span>,</span>
<span id="cb53-196"><a href="#cb53-196" aria-hidden="true" tabindex="-1"></a>                 <span class="at">approx_d_between_groups =</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.20</span>, <span class="fl">1.00</span>),</span>
<span id="cb53-197"><a href="#cb53-197" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">42</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-198"><a href="#cb53-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">truffle_demographics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-199"><a href="#cb53-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">str_replace_all</span>(.x, <span class="st">"X"</span>, <span class="st">"depression_scale"</span>))</span>
<span id="cb53-200"><a href="#cb53-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-201"><a href="#cb53-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-202"><a href="#cb53-202" aria-hidden="true" tabindex="-1"></a>Let's start by printing the column names:</span>
<span id="cb53-203"><a href="#cb53-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-206"><a href="#cb53-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-207"><a href="#cb53-207" aria-hidden="true" tabindex="-1"></a>dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-208"><a href="#cb53-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-209"><a href="#cb53-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span>
<span id="cb53-210"><a href="#cb53-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-211"><a href="#cb53-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-212"><a href="#cb53-212" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-213"><a href="#cb53-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-214"><a href="#cb53-214" aria-hidden="true" tabindex="-1"></a>Write code to:</span>
<span id="cb53-215"><a href="#cb53-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-216"><a href="#cb53-216" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Create a new data frame called 'dat_fewer_columns'</span>
<span id="cb53-217"><a href="#cb53-217" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span><span class="in">`select()`</span> all the columns beginning with "depression", using only positive selections</span>
<span id="cb53-218"><a href="#cb53-218" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Print the column names to confirm that these are the only ones present</span>
<span id="cb53-219"><a href="#cb53-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-222"><a href="#cb53-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-223"><a href="#cb53-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-224"><a href="#cb53-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-225"><a href="#cb53-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-226"><a href="#cb53-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-227"><a href="#cb53-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-228"><a href="#cb53-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-229"><a href="#cb53-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-230"><a href="#cb53-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-231"><a href="#cb53-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-232"><a href="#cb53-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-233"><a href="#cb53-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-234"><a href="#cb53-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-235"><a href="#cb53-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-236"><a href="#cb53-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-237"><a href="#cb53-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-238"><a href="#cb53-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-239"><a href="#cb53-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-240"><a href="#cb53-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-241"><a href="#cb53-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-242"><a href="#cb53-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-243"><a href="#cb53-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-244"><a href="#cb53-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-245"><a href="#cb53-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-246"><a href="#cb53-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-247"><a href="#cb53-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-248"><a href="#cb53-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-249"><a href="#cb53-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-250"><a href="#cb53-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-251"><a href="#cb53-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-252"><a href="#cb53-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-253"><a href="#cb53-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-254"><a href="#cb53-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-255"><a href="#cb53-255" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-258"><a href="#cb53-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-259"><a href="#cb53-259" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-260"><a href="#cb53-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(depression_scale1_item1, </span>
<span id="cb53-261"><a href="#cb53-261" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item2, </span>
<span id="cb53-262"><a href="#cb53-262" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item3, </span>
<span id="cb53-263"><a href="#cb53-263" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item4, </span>
<span id="cb53-264"><a href="#cb53-264" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item5, </span>
<span id="cb53-265"><a href="#cb53-265" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item6, </span>
<span id="cb53-266"><a href="#cb53-266" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item7, </span>
<span id="cb53-267"><a href="#cb53-267" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item8, </span>
<span id="cb53-268"><a href="#cb53-268" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item9, </span>
<span id="cb53-269"><a href="#cb53-269" aria-hidden="true" tabindex="-1"></a>         depression_scale1_item10, </span>
<span id="cb53-270"><a href="#cb53-270" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item1, </span>
<span id="cb53-271"><a href="#cb53-271" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item2, </span>
<span id="cb53-272"><a href="#cb53-272" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item3, </span>
<span id="cb53-273"><a href="#cb53-273" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item4, </span>
<span id="cb53-274"><a href="#cb53-274" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item5, </span>
<span id="cb53-275"><a href="#cb53-275" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item6, </span>
<span id="cb53-276"><a href="#cb53-276" aria-hidden="true" tabindex="-1"></a>         depression_scale2_item7, </span>
<span id="cb53-277"><a href="#cb53-277" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item1, </span>
<span id="cb53-278"><a href="#cb53-278" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item2, </span>
<span id="cb53-279"><a href="#cb53-279" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item3, </span>
<span id="cb53-280"><a href="#cb53-280" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item4, </span>
<span id="cb53-281"><a href="#cb53-281" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item5, </span>
<span id="cb53-282"><a href="#cb53-282" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item6, </span>
<span id="cb53-283"><a href="#cb53-283" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item7, </span>
<span id="cb53-284"><a href="#cb53-284" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item8, </span>
<span id="cb53-285"><a href="#cb53-285" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item9, </span>
<span id="cb53-286"><a href="#cb53-286" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item10, </span>
<span id="cb53-287"><a href="#cb53-287" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item11, </span>
<span id="cb53-288"><a href="#cb53-288" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item12, </span>
<span id="cb53-289"><a href="#cb53-289" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item13, </span>
<span id="cb53-290"><a href="#cb53-290" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item14, </span>
<span id="cb53-291"><a href="#cb53-291" aria-hidden="true" tabindex="-1"></a>         depression_scale3_item15)</span>
<span id="cb53-292"><a href="#cb53-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-293"><a href="#cb53-293" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-294"><a href="#cb53-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-295"><a href="#cb53-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span>
<span id="cb53-296"><a href="#cb53-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-297"><a href="#cb53-297" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-298"><a href="#cb53-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-299"><a href="#cb53-299" aria-hidden="true" tabindex="-1"></a>This can be done more easily with <span class="in">`tidyselect::starts_with()`</span>:</span>
<span id="cb53-300"><a href="#cb53-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-303"><a href="#cb53-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-304"><a href="#cb53-304" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyselect)</span>
<span id="cb53-305"><a href="#cb53-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-306"><a href="#cb53-306" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-307"><a href="#cb53-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"depression"</span>))</span>
<span id="cb53-308"><a href="#cb53-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-309"><a href="#cb53-309" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-310"><a href="#cb53-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-311"><a href="#cb53-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span>
<span id="cb53-312"><a href="#cb53-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-313"><a href="#cb53-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-314"><a href="#cb53-314" aria-hidden="true" tabindex="-1"></a>There are many other {tidyselect} helper functions including:</span>
<span id="cb53-315"><a href="#cb53-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-316"><a href="#cb53-316" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`starts_with()`</span> : Selects columns ending in a character string</span>
<span id="cb53-317"><a href="#cb53-317" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ends_with()`</span> : Selects columns ending in a character string</span>
<span id="cb53-318"><a href="#cb53-318" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`contains()`</span> : Selects columns containing a character string, not necessarily at the start or end</span>
<span id="cb53-319"><a href="#cb53-319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`all_of()`</span> : Selects all of the column names in a vector e.g., <span class="in">`all_of(c("a", "b"))`</span></span>
<span id="cb53-320"><a href="#cb53-320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`any_of()`</span> : Selects any of the column names in a vector that are present, silently dropping missing ones. This can be very useful when columns may or may not be present, but has the risk of creating silent errors.</span>
<span id="cb53-321"><a href="#cb53-321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`where()`</span> : Select columns that meet a criterion, e.g., <span class="in">`where(is.numeric)`</span> selects only columns containing numeric data.</span>
<span id="cb53-322"><a href="#cb53-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`everything()`</span> : Selects all columns. This will seem redundant right now, but will become useful later on when we cover <span class="in">`pivot_`</span> functions</span>
<span id="cb53-323"><a href="#cb53-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-324"><a href="#cb53-324" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-325"><a href="#cb53-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-326"><a href="#cb53-326" aria-hidden="true" tabindex="-1"></a>Write code to select all columns for scale 2 from the 'dat_many_columns' data frame.</span>
<span id="cb53-327"><a href="#cb53-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-330"><a href="#cb53-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-331"><a href="#cb53-331" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-332"><a href="#cb53-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-333"><a href="#cb53-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-334"><a href="#cb53-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-335"><a href="#cb53-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-336"><a href="#cb53-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-337"><a href="#cb53-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-338"><a href="#cb53-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-339"><a href="#cb53-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-340"><a href="#cb53-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-341"><a href="#cb53-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-342"><a href="#cb53-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-343"><a href="#cb53-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-344"><a href="#cb53-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-345"><a href="#cb53-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-346"><a href="#cb53-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-347"><a href="#cb53-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-348"><a href="#cb53-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-349"><a href="#cb53-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-350"><a href="#cb53-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-351"><a href="#cb53-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-352"><a href="#cb53-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-353"><a href="#cb53-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-354"><a href="#cb53-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-355"><a href="#cb53-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-356"><a href="#cb53-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-357"><a href="#cb53-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-358"><a href="#cb53-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-359"><a href="#cb53-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-360"><a href="#cb53-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-361"><a href="#cb53-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-362"><a href="#cb53-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-363"><a href="#cb53-363" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-366"><a href="#cb53-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-367"><a href="#cb53-367" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-368"><a href="#cb53-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"scale2"</span>))</span>
<span id="cb53-369"><a href="#cb53-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-370"><a href="#cb53-370" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-371"><a href="#cb53-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-372"><a href="#cb53-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span>
<span id="cb53-373"><a href="#cb53-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-374"><a href="#cb53-374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-375"><a href="#cb53-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-376"><a href="#cb53-376" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-377"><a href="#cb53-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-378"><a href="#cb53-378" aria-hidden="true" tabindex="-1"></a>Write code to select from the 'dat_many_columns' data frame the "id", "age" and "gender" columns AND all columns related to item3.</span>
<span id="cb53-379"><a href="#cb53-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-382"><a href="#cb53-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-383"><a href="#cb53-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-384"><a href="#cb53-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-385"><a href="#cb53-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-386"><a href="#cb53-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-387"><a href="#cb53-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-388"><a href="#cb53-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-389"><a href="#cb53-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-390"><a href="#cb53-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-391"><a href="#cb53-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-392"><a href="#cb53-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-393"><a href="#cb53-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-394"><a href="#cb53-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-395"><a href="#cb53-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-396"><a href="#cb53-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-397"><a href="#cb53-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-398"><a href="#cb53-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-399"><a href="#cb53-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-400"><a href="#cb53-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-401"><a href="#cb53-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-402"><a href="#cb53-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-403"><a href="#cb53-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-404"><a href="#cb53-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-405"><a href="#cb53-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-406"><a href="#cb53-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-407"><a href="#cb53-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-408"><a href="#cb53-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-409"><a href="#cb53-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-410"><a href="#cb53-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-411"><a href="#cb53-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-412"><a href="#cb53-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-413"><a href="#cb53-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-414"><a href="#cb53-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-415"><a href="#cb53-415" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-418"><a href="#cb53-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-419"><a href="#cb53-419" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-420"><a href="#cb53-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, gender, <span class="fu">contains</span>(<span class="st">"item3"</span>))</span>
<span id="cb53-421"><a href="#cb53-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-422"><a href="#cb53-422" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-423"><a href="#cb53-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-424"><a href="#cb53-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span>
<span id="cb53-425"><a href="#cb53-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-426"><a href="#cb53-426" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-427"><a href="#cb53-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-428"><a href="#cb53-428" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-429"><a href="#cb53-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-430"><a href="#cb53-430" aria-hidden="true" tabindex="-1"></a>Write code to select the "id", "age" and "gender" columns AND all columns related to item1.</span>
<span id="cb53-431"><a href="#cb53-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-432"><a href="#cb53-432" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-435"><a href="#cb53-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-436"><a href="#cb53-436" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-437"><a href="#cb53-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, gender, <span class="fu">ends_with</span>(<span class="st">"item1"</span>))</span>
<span id="cb53-438"><a href="#cb53-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-439"><a href="#cb53-439" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-440"><a href="#cb53-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-441"><a href="#cb53-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span>
<span id="cb53-442"><a href="#cb53-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-443"><a href="#cb53-443" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-444"><a href="#cb53-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-445"><a href="#cb53-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selection with set operations</span></span>
<span id="cb53-446"><a href="#cb53-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-447"><a href="#cb53-447" aria-hidden="true" tabindex="-1"></a>Negative selection using <span class="in">`-`</span> is selection using a "set operation" or a set of logical rules that determine which column names are in the selected set. There are others:</span>
<span id="cb53-448"><a href="#cb53-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-449"><a href="#cb53-449" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Set operations:</span>
<span id="cb53-450"><a href="#cb53-450" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`-`</span> negative selection</span>
<span id="cb53-451"><a href="#cb53-451" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`c()`</span> : combine selections</span>
<span id="cb53-452"><a href="#cb53-452" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`!`</span> invert selection</span>
<span id="cb53-453"><a href="#cb53-453" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`&amp;`</span> must meet both selection rules</span>
<span id="cb53-454"><a href="#cb53-454" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`|`</span> can meet either selection criteria</span>
<span id="cb53-455"><a href="#cb53-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-456"><a href="#cb53-456" aria-hidden="true" tabindex="-1"></a>For example: select columns that refer to scale 3 AND items <span class="sc">\&gt;</span>=10:</span>
<span id="cb53-457"><a href="#cb53-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-460"><a href="#cb53-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-461"><a href="#cb53-461" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="ot">&lt;-</span> dat_many_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-462"><a href="#cb53-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, gender, </span>
<span id="cb53-463"><a href="#cb53-463" aria-hidden="true" tabindex="-1"></a>         <span class="co"># items containing scale3 AND item1 but NOT item 1</span></span>
<span id="cb53-464"><a href="#cb53-464" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="fu">contains</span>(<span class="st">"scale3"</span>) <span class="sc">&amp;</span> <span class="fu">contains</span>(<span class="st">"item1"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">ends_with</span>(<span class="st">"item1"</span>)))</span>
<span id="cb53-465"><a href="#cb53-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-466"><a href="#cb53-466" aria-hidden="true" tabindex="-1"></a>dat_fewer_columns <span class="sc">%&gt;%</span></span>
<span id="cb53-467"><a href="#cb53-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-468"><a href="#cb53-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dput</span>()</span>
<span id="cb53-469"><a href="#cb53-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-470"><a href="#cb53-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-471"><a href="#cb53-471" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-472"><a href="#cb53-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-473"><a href="#cb53-473" aria-hidden="true" tabindex="-1"></a>To practice {tidyselect} helpers and selection set operations, write code in a creative and unnecessarily complex way to select the columns "id", "gender", and "age", and the items from scale 1 and scale 3 that whose items are <span class="sc">\&lt;</span>= 10.</span>
<span id="cb53-474"><a href="#cb53-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-475"><a href="#cb53-475" aria-hidden="true" tabindex="-1"></a>Note: no solution provided here as many different ones are possible.</span>
<span id="cb53-476"><a href="#cb53-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-479"><a href="#cb53-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-480"><a href="#cb53-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-481"><a href="#cb53-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-482"><a href="#cb53-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-483"><a href="#cb53-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-484"><a href="#cb53-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-485"><a href="#cb53-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-486"><a href="#cb53-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-487"><a href="#cb53-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-488"><a href="#cb53-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-489"><a href="#cb53-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-490"><a href="#cb53-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-491"><a href="#cb53-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-492"><a href="#cb53-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-493"><a href="#cb53-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-494"><a href="#cb53-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-495"><a href="#cb53-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-496"><a href="#cb53-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-497"><a href="#cb53-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-498"><a href="#cb53-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-499"><a href="#cb53-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-500"><a href="#cb53-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-501"><a href="#cb53-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-502"><a href="#cb53-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-503"><a href="#cb53-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-504"><a href="#cb53-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-505"><a href="#cb53-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-506"><a href="#cb53-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-507"><a href="#cb53-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-508"><a href="#cb53-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-509"><a href="#cb53-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-510"><a href="#cb53-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-511"><a href="#cb53-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-512"><a href="#cb53-512" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practicing select and the pipe in a longer chunk</span></span>
<span id="cb53-513"><a href="#cb53-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-514"><a href="#cb53-514" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-515"><a href="#cb53-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-516"><a href="#cb53-516" aria-hidden="true" tabindex="-1"></a>The first chunk in this chapter read in the 'data_demographics_raw_messy.csv' file and renamed columns.</span>
<span id="cb53-517"><a href="#cb53-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-518"><a href="#cb53-518" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rewrite that chunk here - as much as possible from memory, without simply copy pasting.</span>
<span id="cb53-519"><a href="#cb53-519" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Add another pipe and selecting the "id", "question" and "response" columns.</span>
<span id="cb53-520"><a href="#cb53-520" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Print a table of the resulting data frame using <span class="in">`kable()`</span> and <span class="in">`kable_class()`</span></span>
<span id="cb53-521"><a href="#cb53-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-522"><a href="#cb53-522" aria-hidden="true" tabindex="-1"></a>Note: no solution provided here to reduce the temptation to peek or copy-paste.</span>
<span id="cb53-523"><a href="#cb53-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-526"><a href="#cb53-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-527"><a href="#cb53-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-528"><a href="#cb53-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-529"><a href="#cb53-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-530"><a href="#cb53-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-531"><a href="#cb53-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-532"><a href="#cb53-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-533"><a href="#cb53-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-534"><a href="#cb53-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-535"><a href="#cb53-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-536"><a href="#cb53-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-537"><a href="#cb53-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-538"><a href="#cb53-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-539"><a href="#cb53-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-540"><a href="#cb53-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-541"><a href="#cb53-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-542"><a href="#cb53-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-543"><a href="#cb53-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-544"><a href="#cb53-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-545"><a href="#cb53-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-546"><a href="#cb53-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-547"><a href="#cb53-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-548"><a href="#cb53-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-549"><a href="#cb53-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-550"><a href="#cb53-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-551"><a href="#cb53-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-552"><a href="#cb53-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-553"><a href="#cb53-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-554"><a href="#cb53-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-555"><a href="#cb53-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-556"><a href="#cb53-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-557"><a href="#cb53-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-558"><a href="#cb53-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-559"><a href="#cb53-559" aria-hidden="true" tabindex="-1"></a><span class="fu">## Moving columns with `dplyr::relocate()`</span></span>
<span id="cb53-560"><a href="#cb53-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-561"><a href="#cb53-561" aria-hidden="true" tabindex="-1"></a>You can reorder to columns within a data frame with <span class="in">`relocate()`</span>.</span>
<span id="cb53-562"><a href="#cb53-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-563"><a href="#cb53-563" aria-hidden="true" tabindex="-1"></a>Unlike <span class="in">`rename()`</span>, <span class="in">`select()`</span>, and other functions, only one column can be relocated with each <span class="in">`relocate()`</span> call.</span>
<span id="cb53-564"><a href="#cb53-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-565"><a href="#cb53-565" aria-hidden="true" tabindex="-1"></a>You can relocate columns before or after others, or to locations such as being the first or last column. This code moves the "response" column to be before the "question" column, and the "correct" column to be the last one.</span>
<span id="cb53-566"><a href="#cb53-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-569"><a href="#cb53-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-570"><a href="#cb53-570" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-571"><a href="#cb53-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(response, <span class="at">.before =</span> <span class="st">"question"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-572"><a href="#cb53-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(correct, <span class="at">.after =</span> <span class="fu">last_col</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-573"><a href="#cb53-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-574"><a href="#cb53-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-575"><a href="#cb53-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-576"><a href="#cb53-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-577"><a href="#cb53-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-578"><a href="#cb53-578" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-579"><a href="#cb53-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-580"><a href="#cb53-580" aria-hidden="true" tabindex="-1"></a>What code is needed to relocate the columns of 'dat_demographics_renamed' so that they are in the order "id", "question", "response", and then the remaining columns.</span>
<span id="cb53-581"><a href="#cb53-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-584"><a href="#cb53-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-585"><a href="#cb53-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-586"><a href="#cb53-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-587"><a href="#cb53-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-588"><a href="#cb53-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-589"><a href="#cb53-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-590"><a href="#cb53-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-591"><a href="#cb53-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-592"><a href="#cb53-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-593"><a href="#cb53-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-594"><a href="#cb53-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-595"><a href="#cb53-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-596"><a href="#cb53-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-597"><a href="#cb53-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-598"><a href="#cb53-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-599"><a href="#cb53-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-600"><a href="#cb53-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-601"><a href="#cb53-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-602"><a href="#cb53-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-603"><a href="#cb53-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-604"><a href="#cb53-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-605"><a href="#cb53-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-606"><a href="#cb53-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-607"><a href="#cb53-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-608"><a href="#cb53-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-609"><a href="#cb53-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-610"><a href="#cb53-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-611"><a href="#cb53-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-612"><a href="#cb53-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-613"><a href="#cb53-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-614"><a href="#cb53-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-615"><a href="#cb53-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-616"><a href="#cb53-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-617"><a href="#cb53-617" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-620"><a href="#cb53-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-621"><a href="#cb53-621" aria-hidden="true" tabindex="-1"></a>dat_demographics_reordered <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-622"><a href="#cb53-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-623"><a href="#cb53-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(question, <span class="at">.after =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-624"><a href="#cb53-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(response, <span class="at">.after =</span> <span class="st">"question"</span>)</span>
<span id="cb53-625"><a href="#cb53-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-626"><a href="#cb53-626" aria-hidden="true" tabindex="-1"></a>dat_demographics_reordered <span class="sc">%&gt;%</span></span>
<span id="cb53-627"><a href="#cb53-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-628"><a href="#cb53-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-629"><a href="#cb53-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-630"><a href="#cb53-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-631"><a href="#cb53-631" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-632"><a href="#cb53-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-633"><a href="#cb53-633" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-634"><a href="#cb53-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-635"><a href="#cb53-635" aria-hidden="true" tabindex="-1"></a>All three of the solutions below accomplish the goal of making the "id" column the first column:</span>
<span id="cb53-636"><a href="#cb53-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-639"><a href="#cb53-639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-640"><a href="#cb53-640" aria-hidden="true" tabindex="-1"></a><span class="co"># move "id" to be the first column by placing it before "date"</span></span>
<span id="cb53-641"><a href="#cb53-641" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-642"><a href="#cb53-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> <span class="st">"date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-643"><a href="#cb53-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-644"><a href="#cb53-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-645"><a href="#cb53-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-646"><a href="#cb53-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-647"><a href="#cb53-647" aria-hidden="true" tabindex="-1"></a><span class="co"># move "date" to be the second column by placing it after "id", producing the same result</span></span>
<span id="cb53-648"><a href="#cb53-648" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-649"><a href="#cb53-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(date, <span class="at">.after =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-650"><a href="#cb53-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-651"><a href="#cb53-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-652"><a href="#cb53-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-653"><a href="#cb53-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-654"><a href="#cb53-654" aria-hidden="true" tabindex="-1"></a><span class="co"># move "id" to be the 1st column by placing it before the first column by location, producing the same result</span></span>
<span id="cb53-655"><a href="#cb53-655" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-656"><a href="#cb53-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(id, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-657"><a href="#cb53-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-658"><a href="#cb53-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-659"><a href="#cb53-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-660"><a href="#cb53-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-661"><a href="#cb53-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-662"><a href="#cb53-662" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span> Which of the above solutions is the least 'fragile' solution, i.e., that is robust to changes in the data or elsewhere in your data processing code?</span>
<span id="cb53-663"><a href="#cb53-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-664"><a href="#cb53-664" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-665"><a href="#cb53-665" aria-hidden="true" tabindex="-1"></a><span class="in">`relocate(id, .before = 1)`</span> does not rely on the name and location of another column and is therefore the least fragile solution.</span>
<span id="cb53-666"><a href="#cb53-666" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-667"><a href="#cb53-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-668"><a href="#cb53-668" aria-hidden="true" tabindex="-1"></a><span class="fu">## Renaming, relocating, and selecting all-in-one with `select()`</span></span>
<span id="cb53-669"><a href="#cb53-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-670"><a href="#cb53-670" aria-hidden="true" tabindex="-1"></a>Renaming, relocating, and selecting columns are so common as a set of three tasks that you can do it all within <span class="in">`select()`</span>.</span>
<span id="cb53-671"><a href="#cb53-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-672"><a href="#cb53-672" aria-hidden="true" tabindex="-1"></a>Whatever order columns appear in <span class="in">`select()`</span> they will be relocated to. You can rename variables inside select just as you do in <span class="in">`rename()`</span> using <span class="in">`new_name = old_name`</span>.</span>
<span id="cb53-673"><a href="#cb53-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-676"><a href="#cb53-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-677"><a href="#cb53-677" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-678"><a href="#cb53-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, date, question, <span class="at">answer =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb53-679"><a href="#cb53-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-680"><a href="#cb53-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-681"><a href="#cb53-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-682"><a href="#cb53-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-683"><a href="#cb53-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-684"><a href="#cb53-684" aria-hidden="true" tabindex="-1"></a><span class="fu">## Keeping or dropping rows with `dplyr::filter()`</span></span>
<span id="cb53-685"><a href="#cb53-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-686"><a href="#cb53-686" aria-hidden="true" tabindex="-1"></a>Not all rows in a dataset are useful to us. When processing data, we often wish to keep only some rows and drop others. We can do this with <span class="in">`dplyr::filter()`</span>.</span>
<span id="cb53-687"><a href="#cb53-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-688"><a href="#cb53-688" aria-hidden="true" tabindex="-1"></a>It is important to learn the difference between <span class="in">`select()`</span> and <span class="in">`filter()`</span>, it is initially confusing.</span>
<span id="cb53-689"><a href="#cb53-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-690"><a href="#cb53-690" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`select()`</span> keeps or drops **columns**</span>
<span id="cb53-691"><a href="#cb53-691" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`filter()`</span> keeps or drops **rows**</span>
<span id="cb53-692"><a href="#cb53-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-693"><a href="#cb53-693" aria-hidden="true" tabindex="-1"></a>For example, filter the 'question' column to contain only "age" items:</span>
<span id="cb53-694"><a href="#cb53-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-697"><a href="#cb53-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-698"><a href="#cb53-698" aria-hidden="true" tabindex="-1"></a>dat_filtered_age <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-699"><a href="#cb53-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"age"</span>)</span>
<span id="cb53-700"><a href="#cb53-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-701"><a href="#cb53-701" aria-hidden="true" tabindex="-1"></a>dat_filtered_age <span class="sc">%&gt;%</span></span>
<span id="cb53-702"><a href="#cb53-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-703"><a href="#cb53-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-704"><a href="#cb53-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-705"><a href="#cb53-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-706"><a href="#cb53-706" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-707"><a href="#cb53-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-708"><a href="#cb53-708" aria-hidden="true" tabindex="-1"></a>Write code to:</span>
<span id="cb53-709"><a href="#cb53-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-710"><a href="#cb53-710" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Take the 'dat_demographics_renamed' data frame.</span>
<span id="cb53-711"><a href="#cb53-711" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create two data frames called 'dat_filtered_age' and 'dat_filtered_gender'.</span>
<span id="cb53-712"><a href="#cb53-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Retain only the relevant rows of 'question' for each.</span>
<span id="cb53-713"><a href="#cb53-713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rename the 'response' columns to what variable it now contains.</span>
<span id="cb53-714"><a href="#cb53-714" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Drop the 'question' columns since they're now irrelevant.</span>
<span id="cb53-715"><a href="#cb53-715" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Print a table of each data frame.</span>
<span id="cb53-716"><a href="#cb53-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-719"><a href="#cb53-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-720"><a href="#cb53-720" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-721"><a href="#cb53-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-722"><a href="#cb53-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-723"><a href="#cb53-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-724"><a href="#cb53-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-725"><a href="#cb53-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-726"><a href="#cb53-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-727"><a href="#cb53-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-728"><a href="#cb53-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-729"><a href="#cb53-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-730"><a href="#cb53-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-731"><a href="#cb53-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-732"><a href="#cb53-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-733"><a href="#cb53-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-734"><a href="#cb53-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-735"><a href="#cb53-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-736"><a href="#cb53-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-737"><a href="#cb53-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-738"><a href="#cb53-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-739"><a href="#cb53-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-740"><a href="#cb53-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-741"><a href="#cb53-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-742"><a href="#cb53-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-743"><a href="#cb53-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-744"><a href="#cb53-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-745"><a href="#cb53-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-746"><a href="#cb53-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-747"><a href="#cb53-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-748"><a href="#cb53-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-749"><a href="#cb53-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-750"><a href="#cb53-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-751"><a href="#cb53-751" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-754"><a href="#cb53-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-755"><a href="#cb53-755" aria-hidden="true" tabindex="-1"></a>dat_filtered_age <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-756"><a href="#cb53-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-757"><a href="#cb53-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">age =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb53-758"><a href="#cb53-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>question)</span>
<span id="cb53-759"><a href="#cb53-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-760"><a href="#cb53-760" aria-hidden="true" tabindex="-1"></a>dat_filtered_age <span class="sc">%&gt;%</span></span>
<span id="cb53-761"><a href="#cb53-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-762"><a href="#cb53-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-763"><a href="#cb53-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-764"><a href="#cb53-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-765"><a href="#cb53-765" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-766"><a href="#cb53-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"gender"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-767"><a href="#cb53-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gender =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb53-768"><a href="#cb53-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>question)</span>
<span id="cb53-769"><a href="#cb53-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-770"><a href="#cb53-770" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb53-771"><a href="#cb53-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-772"><a href="#cb53-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-773"><a href="#cb53-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-774"><a href="#cb53-774" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-775"><a href="#cb53-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-776"><a href="#cb53-776" aria-hidden="true" tabindex="-1"></a><span class="fu">### Filters with set operations</span></span>
<span id="cb53-777"><a href="#cb53-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-778"><a href="#cb53-778" aria-hidden="true" tabindex="-1"></a>You can specify the logical test for filtering in many ways, including:</span>
<span id="cb53-779"><a href="#cb53-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-780"><a href="#cb53-780" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`==`</span> : 'is exactly equal to this one value'</span>
<span id="cb53-781"><a href="#cb53-781" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`!=`</span> : 'is not exactly equal to</span>
<span id="cb53-782"><a href="#cb53-782" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`%in%`</span> : 'is exactly equal to one of the following values'</span>
<span id="cb53-783"><a href="#cb53-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-784"><a href="#cb53-784" aria-hidden="true" tabindex="-1"></a>Note that equivalence is two equals signs (<span class="in">`==`</span>) whereas setting arguments in functions is one (<span class="in">`=`</span>).</span>
<span id="cb53-785"><a href="#cb53-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-788"><a href="#cb53-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-789"><a href="#cb53-789" aria-hidden="true" tabindex="-1"></a><span class="co"># '==' exactly equal to</span></span>
<span id="cb53-790"><a href="#cb53-790" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb53-791"><a href="#cb53-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"female"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-792"><a href="#cb53-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-793"><a href="#cb53-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-794"><a href="#cb53-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-795"><a href="#cb53-795" aria-hidden="true" tabindex="-1"></a><span class="co"># '!=' is not exactly equal to</span></span>
<span id="cb53-796"><a href="#cb53-796" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb53-797"><a href="#cb53-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"female"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-798"><a href="#cb53-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-799"><a href="#cb53-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-800"><a href="#cb53-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-801"><a href="#cb53-801" aria-hidden="true" tabindex="-1"></a><span class="co"># '%in%' is exactly equal to one of the following</span></span>
<span id="cb53-802"><a href="#cb53-802" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb53-803"><a href="#cb53-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-804"><a href="#cb53-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-805"><a href="#cb53-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-806"><a href="#cb53-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-807"><a href="#cb53-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-808"><a href="#cb53-808" aria-hidden="true" tabindex="-1"></a>Weirdly, there is no single function that provides the combination of <span class="in">`%in%`</span> and <span class="in">`!=`</span>, i.e., 'is not exactly equal to any of the following values'. This can be achieved with the following, although it is not intuitive:</span>
<span id="cb53-809"><a href="#cb53-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-812"><a href="#cb53-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-813"><a href="#cb53-813" aria-hidden="true" tabindex="-1"></a><span class="co"># '!' and '%in%'</span></span>
<span id="cb53-814"><a href="#cb53-814" aria-hidden="true" tabindex="-1"></a>dat_filtered_gender <span class="sc">%&gt;%</span></span>
<span id="cb53-815"><a href="#cb53-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-816"><a href="#cb53-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-817"><a href="#cb53-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-818"><a href="#cb53-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-819"><a href="#cb53-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-820"><a href="#cb53-820" aria-hidden="true" tabindex="-1"></a>You can also combine multiple tests with various operators:</span>
<span id="cb53-821"><a href="#cb53-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-822"><a href="#cb53-822" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&amp;`</span> : AND, i.e., meeting both criterion.</span>
<span id="cb53-823"><a href="#cb53-823" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`|`</span> : OR, i.e., meeting either criterion.</span>
<span id="cb53-824"><a href="#cb53-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-827"><a href="#cb53-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-828"><a href="#cb53-828" aria-hidden="true" tabindex="-1"></a><span class="co"># &amp; criterion X and Y</span></span>
<span id="cb53-829"><a href="#cb53-829" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-830"><a href="#cb53-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"gender"</span> <span class="sc">&amp;</span> response <span class="sc">==</span> <span class="st">"female"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb53-831"><a href="#cb53-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-832"><a href="#cb53-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-833"><a href="#cb53-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-834"><a href="#cb53-834" aria-hidden="true" tabindex="-1"></a><span class="co"># | criterion X or Y</span></span>
<span id="cb53-835"><a href="#cb53-835" aria-hidden="true" tabindex="-1"></a>dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-836"><a href="#cb53-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"gender"</span> <span class="sc">|</span> response <span class="sc">==</span> <span class="st">"female"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb53-837"><a href="#cb53-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-838"><a href="#cb53-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-839"><a href="#cb53-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-840"><a href="#cb53-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-841"><a href="#cb53-841" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-842"><a href="#cb53-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-843"><a href="#cb53-843" aria-hidden="true" tabindex="-1"></a>Write code to:</span>
<span id="cb53-844"><a href="#cb53-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-845"><a href="#cb53-845" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Take the 'dat_demographics_renamed' data frame.</span>
<span id="cb53-846"><a href="#cb53-846" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create the data frame 'dat_filtered_rt'.</span>
<span id="cb53-847"><a href="#cb53-847" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Retain only rows where where reaction time ('re') is more than 500 ms.</span>
<span id="cb53-848"><a href="#cb53-848" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Print a table of each data frame.</span>
<span id="cb53-849"><a href="#cb53-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-852"><a href="#cb53-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-853"><a href="#cb53-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-854"><a href="#cb53-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-855"><a href="#cb53-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-856"><a href="#cb53-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-857"><a href="#cb53-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-858"><a href="#cb53-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-859"><a href="#cb53-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-860"><a href="#cb53-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-861"><a href="#cb53-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-862"><a href="#cb53-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-863"><a href="#cb53-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-864"><a href="#cb53-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-865"><a href="#cb53-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-866"><a href="#cb53-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-867"><a href="#cb53-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-868"><a href="#cb53-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-869"><a href="#cb53-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-870"><a href="#cb53-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-871"><a href="#cb53-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-872"><a href="#cb53-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-873"><a href="#cb53-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-874"><a href="#cb53-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-875"><a href="#cb53-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-876"><a href="#cb53-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-877"><a href="#cb53-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-878"><a href="#cb53-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-879"><a href="#cb53-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-880"><a href="#cb53-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-881"><a href="#cb53-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-882"><a href="#cb53-882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-883"><a href="#cb53-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-884"><a href="#cb53-884" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-887"><a href="#cb53-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-888"><a href="#cb53-888" aria-hidden="true" tabindex="-1"></a>dat_filtered_rt <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-889"><a href="#cb53-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rt <span class="sc">&gt;</span> <span class="dv">500</span>) </span>
<span id="cb53-890"><a href="#cb53-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-891"><a href="#cb53-891" aria-hidden="true" tabindex="-1"></a>dat_filtered_rt <span class="sc">%&gt;%</span></span>
<span id="cb53-892"><a href="#cb53-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-893"><a href="#cb53-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-894"><a href="#cb53-894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-895"><a href="#cb53-895" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-896"><a href="#cb53-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-897"><a href="#cb53-897" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-898"><a href="#cb53-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-899"><a href="#cb53-899" aria-hidden="true" tabindex="-1"></a>Write code to:</span>
<span id="cb53-900"><a href="#cb53-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-901"><a href="#cb53-901" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Take the 'dat_demographics_renamed' data frame.</span>
<span id="cb53-902"><a href="#cb53-902" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create the data frame 'dat_filtered_rt'.</span>
<span id="cb53-903"><a href="#cb53-903" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Retain only rows where where both reaction time ('rt') is more than 500 ms and gender is either 'male', 'female', or 'non-binary'.</span>
<span id="cb53-904"><a href="#cb53-904" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Print a table of each data frame.</span>
<span id="cb53-905"><a href="#cb53-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-908"><a href="#cb53-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-909"><a href="#cb53-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-910"><a href="#cb53-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-911"><a href="#cb53-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-912"><a href="#cb53-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-913"><a href="#cb53-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-914"><a href="#cb53-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-915"><a href="#cb53-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-916"><a href="#cb53-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-917"><a href="#cb53-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-918"><a href="#cb53-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-919"><a href="#cb53-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-920"><a href="#cb53-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-921"><a href="#cb53-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-922"><a href="#cb53-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-923"><a href="#cb53-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-924"><a href="#cb53-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-925"><a href="#cb53-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-926"><a href="#cb53-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-927"><a href="#cb53-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-928"><a href="#cb53-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-929"><a href="#cb53-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-930"><a href="#cb53-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-931"><a href="#cb53-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-932"><a href="#cb53-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-933"><a href="#cb53-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-934"><a href="#cb53-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-935"><a href="#cb53-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-936"><a href="#cb53-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-937"><a href="#cb53-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-938"><a href="#cb53-938" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-939"><a href="#cb53-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-940"><a href="#cb53-940" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-943"><a href="#cb53-943" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-944"><a href="#cb53-944" aria-hidden="true" tabindex="-1"></a>dat_filtered_rt <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-945"><a href="#cb53-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rt <span class="sc">&gt;</span> <span class="dv">500</span> <span class="sc">&amp;</span> question <span class="sc">==</span> <span class="st">'gender'</span> <span class="sc">&amp;</span> response <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'male'</span>, <span class="st">'female'</span>, <span class="st">'non-binary'</span>)) </span>
<span id="cb53-946"><a href="#cb53-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-947"><a href="#cb53-947" aria-hidden="true" tabindex="-1"></a>dat_filtered_rt <span class="sc">%&gt;%</span></span>
<span id="cb53-948"><a href="#cb53-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-949"><a href="#cb53-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-950"><a href="#cb53-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-951"><a href="#cb53-951" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-952"><a href="#cb53-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-953"><a href="#cb53-953" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-954"><a href="#cb53-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-955"><a href="#cb53-955" aria-hidden="true" tabindex="-1"></a>In the above answer, why might it be a good idea to include <span class="in">`question == 'gender'`</span>?</span>
<span id="cb53-956"><a href="#cb53-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-957"><a href="#cb53-957" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-958"><a href="#cb53-958" aria-hidden="true" tabindex="-1"></a>Because the requirement was "...and gender is either 'male', 'female', or 'non-binary'".</span>
<span id="cb53-959"><a href="#cb53-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-960"><a href="#cb53-960" aria-hidden="true" tabindex="-1"></a>If participants responded to another question (e.g., 'age') with 'male', 'female', or 'non-binary', their rows would also be returned.</span>
<span id="cb53-961"><a href="#cb53-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-962"><a href="#cb53-962" aria-hidden="true" tabindex="-1"></a>Being specific to the requirements makes your code less 'brittle' and more likely to catch weird cases in larger datasets.</span>
<span id="cb53-963"><a href="#cb53-963" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-964"><a href="#cb53-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-965"><a href="#cb53-965" aria-hidden="true" tabindex="-1"></a><span class="fu">### Positive vs. negative filters</span></span>
<span id="cb53-966"><a href="#cb53-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-967"><a href="#cb53-967" aria-hidden="true" tabindex="-1"></a>As with <span class="in">`select()`</span>, it is often better to define what you *do* want (`==` and `%&gt;%`) rather than what you *do not* want (<span class="in">`!=`</span> and <span class="in">`!`</span>+<span class="in">`%in%`</span>). This is even more important with <span class="in">`filter()`</span> as unexpected row values are much more common than unexpected column names.</span>
<span id="cb53-968"><a href="#cb53-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-969"><a href="#cb53-969" aria-hidden="true" tabindex="-1"></a>For example, if you specify a negative filter <span class="in">`dat %&gt;% filter(gender != "non-binary)"`</span> because you wish to filter to return only participants who identify as 'male' or 'female', you have in fact only excluded participants who specified 'non-binary'. This code would also return participants with other response options such as 'non binary', 'Non-Binary', 'NB', etc.</span>
<span id="cb53-970"><a href="#cb53-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-971"><a href="#cb53-971" aria-hidden="true" tabindex="-1"></a>However, there can be cases where you specifically do not want some rows or want to retain anything other than a given value. Protecting participant privacy is one of them.</span>
<span id="cb53-972"><a href="#cb53-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-973"><a href="#cb53-973" aria-hidden="true" tabindex="-1"></a>Some rows of the 'dat_demographics_renamed' data frame contain "prolific ID" values, which could be linked back to the individual's Prolific.com account where they completed the study, and therefore risk exposing identifying information. If this data was shared with other researchers or publicly, this could violate the informed consent agreement and/or local data privacy laws. (Note that the prolific IDs included in this data frame are made up.) This is discussed in more detail in the chapter on <span class="co">[</span><span class="ot">Data Privacy</span><span class="co">](privacy.qmd)</span>.</span>
<span id="cb53-974"><a href="#cb53-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-975"><a href="#cb53-975" aria-hidden="true" tabindex="-1"></a>In this case, you would likely need to remove all rows referring to Prolific ID with a negative filter:</span>
<span id="cb53-976"><a href="#cb53-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-979"><a href="#cb53-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-980"><a href="#cb53-980" aria-hidden="true" tabindex="-1"></a>dat_demographics_anonymized <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-981"><a href="#cb53-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">!=</span> <span class="st">"prolific ID"</span>)</span>
<span id="cb53-982"><a href="#cb53-982" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-983"><a href="#cb53-983" aria-hidden="true" tabindex="-1"></a>dat_demographics_anonymized <span class="sc">%&gt;%</span></span>
<span id="cb53-984"><a href="#cb53-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-985"><a href="#cb53-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-986"><a href="#cb53-986" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-987"><a href="#cb53-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-988"><a href="#cb53-988" aria-hidden="true" tabindex="-1"></a>Note that the original 'data_demographics_raw_messy.csv' data file we originally read in to R still contains the Prolific ID codes! Again, see the <span class="co">[</span><span class="ot">Data Privacy</span><span class="co">](privacy.qmd)</span> chapter for how you would deal with this more thoroughly in your own projects.</span>
<span id="cb53-989"><a href="#cb53-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-990"><a href="#cb53-990" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating and modifying columns with `dplyr::mutate()`</span></span>
<span id="cb53-991"><a href="#cb53-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-992"><a href="#cb53-992" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span> is used to create new columns or to change the contents of existing ones.</span>
<span id="cb53-993"><a href="#cb53-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-994"><a href="#cb53-994" aria-hidden="true" tabindex="-1"></a>For example, we can create the 'rt_seconds' column by dividing the 'rt' column, which is in milliseconds, by 1000.</span>
<span id="cb53-995"><a href="#cb53-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-998"><a href="#cb53-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-999"><a href="#cb53-999" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-1000"><a href="#cb53-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_seconds =</span> rt<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb53-1001"><a href="#cb53-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1002"><a href="#cb53-1002" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb53-1003"><a href="#cb53-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1004"><a href="#cb53-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1005"><a href="#cb53-1005" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1006"><a href="#cb53-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1007"><a href="#cb53-1007" aria-hidden="true" tabindex="-1"></a>We can also alter existing columns through self-assignment, i.e., <span class="in">`mutate()`</span>-ing a column based on itself. For example, modifying 'rt' to be in seconds by overwriting the existing 'rt' column:</span>
<span id="cb53-1008"><a href="#cb53-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1011"><a href="#cb53-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1012"><a href="#cb53-1012" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-1013"><a href="#cb53-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt =</span> rt<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb53-1014"><a href="#cb53-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1015"><a href="#cb53-1015" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb53-1016"><a href="#cb53-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1017"><a href="#cb53-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1018"><a href="#cb53-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1019"><a href="#cb53-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1020"><a href="#cb53-1020" aria-hidden="true" tabindex="-1"></a>We can also change types, for example, converting the 'correct' column from numeric (0/1) to logical (TRUE/FALSE).</span>
<span id="cb53-1021"><a href="#cb53-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1024"><a href="#cb53-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1025"><a href="#cb53-1025" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-1026"><a href="#cb53-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">correct =</span> <span class="fu">as.logical</span>(correct))</span>
<span id="cb53-1027"><a href="#cb53-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1028"><a href="#cb53-1028" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb53-1029"><a href="#cb53-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1030"><a href="#cb53-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1031"><a href="#cb53-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1032"><a href="#cb53-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1033"><a href="#cb53-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">### Longer pipes</span></span>
<span id="cb53-1034"><a href="#cb53-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1035"><a href="#cb53-1035" aria-hidden="true" tabindex="-1"></a>A single mutate call can contain multiple mutates. The code from the last chunk could be written more simply like this:</span>
<span id="cb53-1036"><a href="#cb53-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1039"><a href="#cb53-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1040"><a href="#cb53-1040" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-1041"><a href="#cb53-1041" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select only columns of interest</span></span>
<span id="cb53-1042"><a href="#cb53-1042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, question, response, rt, correct) <span class="sc">%&gt;%</span></span>
<span id="cb53-1043"><a href="#cb53-1043" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter only rows of interest</span></span>
<span id="cb53-1044"><a href="#cb53-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">"age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1045"><a href="#cb53-1045" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename columns to make them more intuitive</span></span>
<span id="cb53-1046"><a href="#cb53-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">age =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb53-1047"><a href="#cb53-1047" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate variables</span></span>
<span id="cb53-1048"><a href="#cb53-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rt_ms =</span> rt<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb53-1049"><a href="#cb53-1049" aria-hidden="true" tabindex="-1"></a>         <span class="at">correct =</span> <span class="fu">as.logical</span>(correct)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1050"><a href="#cb53-1050" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select needed columns again</span></span>
<span id="cb53-1051"><a href="#cb53-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, age, rt_ms, correct)</span>
<span id="cb53-1052"><a href="#cb53-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1053"><a href="#cb53-1053" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb53-1054"><a href="#cb53-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1055"><a href="#cb53-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1056"><a href="#cb53-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1057"><a href="#cb53-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1058"><a href="#cb53-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1059"><a href="#cb53-1059" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercise</span></span>
<span id="cb53-1060"><a href="#cb53-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1061"><a href="#cb53-1061" aria-hidden="true" tabindex="-1"></a>Write code to:</span>
<span id="cb53-1062"><a href="#cb53-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1063"><a href="#cb53-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Take the 'dat_demographics_renamed'.</span>
<span id="cb53-1064"><a href="#cb53-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create a data frame named 'dat_demographics_mutated'.</span>
<span id="cb53-1065"><a href="#cb53-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Retain only the gender question rows.</span>
<span id="cb53-1066"><a href="#cb53-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rename 'response' to 'gender'.</span>
<span id="cb53-1067"><a href="#cb53-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use the <span class="in">`stringr::str_to_lower()`</span> function to convert 'gender' to lower case strings'.</span>
<span id="cb53-1068"><a href="#cb53-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Retain only the id and gender columns.</span>
<span id="cb53-1069"><a href="#cb53-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Print the data frame.</span>
<span id="cb53-1070"><a href="#cb53-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1073"><a href="#cb53-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1074"><a href="#cb53-1074" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-1075"><a href="#cb53-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1076"><a href="#cb53-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1077"><a href="#cb53-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1078"><a href="#cb53-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1079"><a href="#cb53-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1080"><a href="#cb53-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1081"><a href="#cb53-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1082"><a href="#cb53-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1083"><a href="#cb53-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1084"><a href="#cb53-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1085"><a href="#cb53-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1086"><a href="#cb53-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1087"><a href="#cb53-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1088"><a href="#cb53-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1089"><a href="#cb53-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1090"><a href="#cb53-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1091"><a href="#cb53-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1092"><a href="#cb53-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1093"><a href="#cb53-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1094"><a href="#cb53-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1095"><a href="#cb53-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1096"><a href="#cb53-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1097"><a href="#cb53-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1098"><a href="#cb53-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1099"><a href="#cb53-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1100"><a href="#cb53-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1101"><a href="#cb53-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1102"><a href="#cb53-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1103"><a href="#cb53-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1104"><a href="#cb53-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1105"><a href="#cb53-1105" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-1108"><a href="#cb53-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1109"><a href="#cb53-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb53-1110"><a href="#cb53-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1111"><a href="#cb53-1111" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="ot">&lt;-</span> dat_demographics_renamed <span class="sc">%&gt;%</span></span>
<span id="cb53-1112"><a href="#cb53-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(question <span class="sc">==</span> <span class="st">'gender'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1113"><a href="#cb53-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gender =</span> response) <span class="sc">%&gt;%</span></span>
<span id="cb53-1114"><a href="#cb53-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1115"><a href="#cb53-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, gender)</span>
<span id="cb53-1116"><a href="#cb53-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1117"><a href="#cb53-1117" aria-hidden="true" tabindex="-1"></a>dat_demographics_mutated <span class="sc">%&gt;%</span></span>
<span id="cb53-1118"><a href="#cb53-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1119"><a href="#cb53-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1120"><a href="#cb53-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1121"><a href="#cb53-1121" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1122"><a href="#cb53-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1123"><a href="#cb53-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">### More complex mutates</span></span>
<span id="cb53-1124"><a href="#cb53-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1127"><a href="#cb53-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1128"><a href="#cb53-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-1129"><a href="#cb53-1129" aria-hidden="true" tabindex="-1"></a><span class="co"># generate some messy demographics data with a larger N</span></span>
<span id="cb53-1130"><a href="#cb53-1130" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github("ianhussey/truffle")</span></span>
<span id="cb53-1131"><a href="#cb53-1131" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(truffle)</span>
<span id="cb53-1132"><a href="#cb53-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1133"><a href="#cb53-1133" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb53-1134"><a href="#cb53-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1135"><a href="#cb53-1135" aria-hidden="true" tabindex="-1"></a>dat_demographics_messy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1136"><a href="#cb53-1136" aria-hidden="true" tabindex="-1"></a>  truffle<span class="sc">::</span><span class="fu">truffle_demographics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1137"><a href="#cb53-1137" aria-hidden="true" tabindex="-1"></a>  truffle<span class="sc">::</span><span class="fu">dirt_demographics</span>()</span>
<span id="cb53-1138"><a href="#cb53-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1139"><a href="#cb53-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1140"><a href="#cb53-1140" aria-hidden="true" tabindex="-1"></a>Most research reports (theses, articles, etc.) report the percentage of the sample that was male, female, etc. For example, the 'dat_demographics_messy' contains messy age and gender data for 500 participants.</span>
<span id="cb53-1141"><a href="#cb53-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1142"><a href="#cb53-1142" aria-hidden="true" tabindex="-1"></a>We'll use <span class="in">`count()`</span> to show every unique response across participants. We'll return to learn to use <span class="in">`count()`</span> properly in the next chapter. For the moment, we're more interested in the output than the code.</span>
<span id="cb53-1143"><a href="#cb53-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1146"><a href="#cb53-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1147"><a href="#cb53-1147" aria-hidden="true" tabindex="-1"></a>dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb53-1148"><a href="#cb53-1148" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find unique values of 'gender' and the frequency of each</span></span>
<span id="cb53-1149"><a href="#cb53-1149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb53-1150"><a href="#cb53-1150" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange these unique cases by descending frequency</span></span>
<span id="cb53-1151"><a href="#cb53-1151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1152"><a href="#cb53-1152" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print table</span></span>
<span id="cb53-1153"><a href="#cb53-1153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1154"><a href="#cb53-1154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1155"><a href="#cb53-1155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1156"><a href="#cb53-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1157"><a href="#cb53-1157" aria-hidden="true" tabindex="-1"></a>Note how the data currently contains many misspellings and use of different cases that cause things like 'female' to appear as a different category to 'Female', etc.</span>
<span id="cb53-1158"><a href="#cb53-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1159"><a href="#cb53-1159" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `mutate()` and working with character strings</span></span>
<span id="cb53-1160"><a href="#cb53-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1161"><a href="#cb53-1161" aria-hidden="true" tabindex="-1"></a>Working with character strings using {stringr} and 'regular expressions' (regex) is a large separate topic in itself.</span>
<span id="cb53-1162"><a href="#cb53-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1163"><a href="#cb53-1163" aria-hidden="true" tabindex="-1"></a>For the moment, know that you can:</span>
<span id="cb53-1164"><a href="#cb53-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1165"><a href="#cb53-1165" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use functions like <span class="in">`str_to_lower()`</span> to convert all text to lower case (as in the above example).</span>
<span id="cb53-1166"><a href="#cb53-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use <span class="in">`str_remove_all()`</span> to remove everything except letters (<span class="in">`str_remove_all(x, "[^A-Za-z]")`</span>) or everything except numbers (<span class="in">`str_remove_all(x, "[^0-9\\.]")`</span>).</span>
<span id="cb53-1167"><a href="#cb53-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1168"><a href="#cb53-1168" aria-hidden="true" tabindex="-1"></a>Above, you used {stringr}'s <span class="in">`str_to_lower()`</span> function to convert all letters to lower case. Let's apply that here to quickly improve things:</span>
<span id="cb53-1169"><a href="#cb53-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1172"><a href="#cb53-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1173"><a href="#cb53-1173" aria-hidden="true" tabindex="-1"></a>dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb53-1174"><a href="#cb53-1174" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to lower case</span></span>
<span id="cb53-1175"><a href="#cb53-1175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">str_to_lower</span>(gender)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1176"><a href="#cb53-1176" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find unique values of 'gender' and the frequency of each</span></span>
<span id="cb53-1177"><a href="#cb53-1177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb53-1178"><a href="#cb53-1178" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange these unique cases by descending frequency</span></span>
<span id="cb53-1179"><a href="#cb53-1179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1180"><a href="#cb53-1180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print table</span></span>
<span id="cb53-1181"><a href="#cb53-1181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1182"><a href="#cb53-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1183"><a href="#cb53-1183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1184"><a href="#cb53-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1185"><a href="#cb53-1185" aria-hidden="true" tabindex="-1"></a>Next we'll use <span class="in">`str_remove_all(x, "[^A-Za-z]")`</span> to remove everything except letters:</span>
<span id="cb53-1186"><a href="#cb53-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1189"><a href="#cb53-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1190"><a href="#cb53-1190" aria-hidden="true" tabindex="-1"></a>dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb53-1191"><a href="#cb53-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-1192"><a href="#cb53-1192" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert to lower case</span></span>
<span id="cb53-1193"><a href="#cb53-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">str_to_lower</span>(gender),</span>
<span id="cb53-1194"><a href="#cb53-1194" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove all non-letters</span></span>
<span id="cb53-1195"><a href="#cb53-1195" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">str_remove_all</span>(gender, <span class="st">"[^A-Za-z]"</span>)</span>
<span id="cb53-1196"><a href="#cb53-1196" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-1197"><a href="#cb53-1197" aria-hidden="true" tabindex="-1"></a>  <span class="co"># find unique values of 'gender' and the frequency of each</span></span>
<span id="cb53-1198"><a href="#cb53-1198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb53-1199"><a href="#cb53-1199" aria-hidden="true" tabindex="-1"></a>  <span class="co"># arrange these unique cases by descending frequency</span></span>
<span id="cb53-1200"><a href="#cb53-1200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1201"><a href="#cb53-1201" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print table</span></span>
<span id="cb53-1202"><a href="#cb53-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1203"><a href="#cb53-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1204"><a href="#cb53-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1205"><a href="#cb53-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1206"><a href="#cb53-1206" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `mutate()` and conditionals rules</span></span>
<span id="cb53-1207"><a href="#cb53-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1208"><a href="#cb53-1208" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Using `dplyr::if_else()`</span></span>
<span id="cb53-1209"><a href="#cb53-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1210"><a href="#cb53-1210" aria-hidden="true" tabindex="-1"></a>If we were being somewhat lazy, we could keep just the three most common self-reported responses to the gender, i.e. 'male', 'female' and 'non-binary', and change the other responses to <span class="in">`NA`</span>.</span>
<span id="cb53-1211"><a href="#cb53-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1212"><a href="#cb53-1212" aria-hidden="true" tabindex="-1"></a>Many forms of data cleaning or 'wrangling' involve applying conditional rules like this to clean up irregular responses, i.e., "if gender is not 'male', 'female' or 'non-binary', then set it to <span class="in">`NA`</span>".</span>
<span id="cb53-1213"><a href="#cb53-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1214"><a href="#cb53-1214" aria-hidden="true" tabindex="-1"></a>The simplest of these is <span class="in">`dplyr::if_else()`</span>, which applies just one if-else. Note that there is a similar function in Base-R, <span class="in">`ifelse()`</span>, but for technical reasons this function is much less safe and can cause weird errors. Try to always use <span class="in">`if_else()`</span>.</span>
<span id="cb53-1215"><a href="#cb53-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1218"><a href="#cb53-1218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1219"><a href="#cb53-1219" aria-hidden="true" tabindex="-1"></a>dat_gender_tidier <span class="ot">&lt;-</span> dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb53-1220"><a href="#cb53-1220" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to lower case and remove non-letters</span></span>
<span id="cb53-1221"><a href="#cb53-1221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">str_to_lower</span>(gender),</span>
<span id="cb53-1222"><a href="#cb53-1222" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> <span class="fu">str_remove_all</span>(gender, <span class="st">"[^A-Za-z]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1223"><a href="#cb53-1223" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy up cases</span></span>
<span id="cb53-1224"><a href="#cb53-1224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">if_else</span>(<span class="at">condition =</span> gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"nonbinary"</span>), <span class="co"># the logical test applied: is 'gender' one of the following</span></span>
<span id="cb53-1225"><a href="#cb53-1225" aria-hidden="true" tabindex="-1"></a>                          <span class="at">true =</span> gender, <span class="co"># what to do if the test is passed: keep the original gender response</span></span>
<span id="cb53-1226"><a href="#cb53-1226" aria-hidden="true" tabindex="-1"></a>                          <span class="at">false =</span> <span class="cn">NA_character_</span>)) <span class="co"># what to do if the test is failed: set it to NA</span></span>
<span id="cb53-1227"><a href="#cb53-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1228"><a href="#cb53-1228" aria-hidden="true" tabindex="-1"></a>dat_gender_tidier <span class="sc">%&gt;%</span></span>
<span id="cb53-1229"><a href="#cb53-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb53-1230"><a href="#cb53-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1231"><a href="#cb53-1231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1232"><a href="#cb53-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1233"><a href="#cb53-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1234"><a href="#cb53-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1235"><a href="#cb53-1235" aria-hidden="true" tabindex="-1"></a>This somewhat quick and dirty solution gives us just four gender categories, 'male', 'female', 'non-binary' and missing (<span class="in">`NA`</span>).</span>
<span id="cb53-1236"><a href="#cb53-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1237"><a href="#cb53-1237" aria-hidden="true" tabindex="-1"></a>Of course, these responses were (mostly) not *really* missing, we removed them to make the responses simpler. This isn't very good practice, as we're throwing away data.</span>
<span id="cb53-1238"><a href="#cb53-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1239"><a href="#cb53-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Using `dplyr::case_when()`</span></span>
<span id="cb53-1240"><a href="#cb53-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1241"><a href="#cb53-1241" aria-hidden="true" tabindex="-1"></a><span class="in">`case_when()`</span> allows you to check against multiple logical tests. It works like this:</span>
<span id="cb53-1242"><a href="#cb53-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1245"><a href="#cb53-1245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1246"><a href="#cb53-1246" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb53-1247"><a href="#cb53-1247" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb53-1248"><a href="#cb53-1248" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb53-1249"><a href="#cb53-1249" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create the variable variable_to_create based on:</span></span>
<span id="cb53-1250"><a href="#cb53-1250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_to_create =</span> <span class="fu">case_when</span>(</span>
<span id="cb53-1251"><a href="#cb53-1251" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if logical_test_1 is met, set variable_to_create to value_1</span></span>
<span id="cb53-1252"><a href="#cb53-1252" aria-hidden="true" tabindex="-1"></a>    logical_test_1 <span class="sc">~</span> value_1, </span>
<span id="cb53-1253"><a href="#cb53-1253" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if logical_test_2 is met, set variable_to_create to value_2</span></span>
<span id="cb53-1254"><a href="#cb53-1254" aria-hidden="true" tabindex="-1"></a>    logical_test_2 <span class="sc">~</span> value_2, </span>
<span id="cb53-1255"><a href="#cb53-1255" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if logical_test_3 is met, set variable_to_create to value_3</span></span>
<span id="cb53-1256"><a href="#cb53-1256" aria-hidden="true" tabindex="-1"></a>    logical_test_3 <span class="sc">~</span> value_3, </span>
<span id="cb53-1257"><a href="#cb53-1257" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 'if none of the above are met, set to the default value value_4'</span></span>
<span id="cb53-1258"><a href="#cb53-1258" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> value_4</span>
<span id="cb53-1259"><a href="#cb53-1259" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb53-1260"><a href="#cb53-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1261"><a href="#cb53-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1262"><a href="#cb53-1262" aria-hidden="true" tabindex="-1"></a>Note that the logical tests are checked in order, so you often have to consider the order in which they are listed and run.</span>
<span id="cb53-1263"><a href="#cb53-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1264"><a href="#cb53-1264" aria-hidden="true" tabindex="-1"></a>We can apply it like this:</span>
<span id="cb53-1265"><a href="#cb53-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1268"><a href="#cb53-1268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1269"><a href="#cb53-1269" aria-hidden="true" tabindex="-1"></a>dat_gender_tidier <span class="ot">&lt;-</span> dat_demographics_messy <span class="sc">%&gt;%</span></span>
<span id="cb53-1270"><a href="#cb53-1270" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to lower case and remove non-letters</span></span>
<span id="cb53-1271"><a href="#cb53-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">str_to_lower</span>(gender),</span>
<span id="cb53-1272"><a href="#cb53-1272" aria-hidden="true" tabindex="-1"></a>         <span class="at">gender =</span> <span class="fu">str_remove_all</span>(gender, <span class="st">"[^A-Za-z]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1273"><a href="#cb53-1273" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy up cases</span></span>
<span id="cb53-1274"><a href="#cb53-1274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">case_when</span>(gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"nonbinary"</span>) <span class="sc">~</span> gender, </span>
<span id="cb53-1275"><a href="#cb53-1275" aria-hidden="true" tabindex="-1"></a>                            gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"femail"</span>, <span class="st">"fem ale"</span>, <span class="st">"femle"</span>, <span class="st">"femlae"</span>) <span class="sc">~</span> <span class="st">"female"</span>,</span>
<span id="cb53-1276"><a href="#cb53-1276" aria-hidden="true" tabindex="-1"></a>                            gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"malee"</span>, <span class="st">"mal"</span>, <span class="st">"ma le"</span>) <span class="sc">~</span> <span class="st">"male"</span>,</span>
<span id="cb53-1277"><a href="#cb53-1277" aria-hidden="true" tabindex="-1"></a>                            gender <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"non binary"</span>, <span class="st">"nonbinary"</span>) <span class="sc">~</span> <span class="st">"non-binary"</span>,</span>
<span id="cb53-1278"><a href="#cb53-1278" aria-hidden="true" tabindex="-1"></a>                            gender <span class="sc">==</span> <span class="st">""</span> <span class="sc">~</span> <span class="cn">NA_character_</span>, <span class="co"># if an empty character string, change to NA_character_</span></span>
<span id="cb53-1279"><a href="#cb53-1279" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> gender)) <span class="co"># if none of the above apply, keep original value</span></span>
<span id="cb53-1280"><a href="#cb53-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1281"><a href="#cb53-1281" aria-hidden="true" tabindex="-1"></a>dat_gender_tidier <span class="sc">%&gt;%</span></span>
<span id="cb53-1282"><a href="#cb53-1282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb53-1283"><a href="#cb53-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1284"><a href="#cb53-1284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-1285"><a href="#cb53-1285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-1286"><a href="#cb53-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1287"><a href="#cb53-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1288"><a href="#cb53-1288" aria-hidden="true" tabindex="-1"></a>Note that the contents of the <span class="in">`case_when()`</span> conditions have to be constructed iteratively. Use <span class="in">`distinct()`</span> to inspect what cases are present, then write code to merge them as desired.</span>
<span id="cb53-1289"><a href="#cb53-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1290"><a href="#cb53-1290" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb53-1291"><a href="#cb53-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1292"><a href="#cb53-1292" aria-hidden="true" tabindex="-1"></a><span class="fu">### `select()` vs. `filter()`</span></span>
<span id="cb53-1293"><a href="#cb53-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1294"><a href="#cb53-1294" aria-hidden="true" tabindex="-1"></a>What is the difference between select and filter?</span>
<span id="cb53-1295"><a href="#cb53-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1296"><a href="#cb53-1296" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-1297"><a href="#cb53-1297" aria-hidden="true" tabindex="-1"></a><span class="in">`select()`</span> is for columns, <span class="in">`filter()`</span> is for rows.</span>
<span id="cb53-1298"><a href="#cb53-1298" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1299"><a href="#cb53-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1300"><a href="#cb53-1300" aria-hidden="true" tabindex="-1"></a><span class="fu">### {tidyselect} helper functions</span></span>
<span id="cb53-1301"><a href="#cb53-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1302"><a href="#cb53-1302" aria-hidden="true" tabindex="-1"></a>Name some helper functions from {tidyselect}.</span>
<span id="cb53-1303"><a href="#cb53-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1304"><a href="#cb53-1304" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-1305"><a href="#cb53-1305" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`starts_with()`</span></span>
<span id="cb53-1306"><a href="#cb53-1306" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ends_with()`</span></span>
<span id="cb53-1307"><a href="#cb53-1307" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`contains()`</span></span>
<span id="cb53-1308"><a href="#cb53-1308" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`all_of()`</span></span>
<span id="cb53-1309"><a href="#cb53-1309" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`any_of()`</span></span>
<span id="cb53-1310"><a href="#cb53-1310" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`where()`</span></span>
<span id="cb53-1311"><a href="#cb53-1311" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`everything()`</span></span>
<span id="cb53-1312"><a href="#cb53-1312" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1313"><a href="#cb53-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1314"><a href="#cb53-1314" aria-hidden="true" tabindex="-1"></a>Explain what each of them do.</span>
<span id="cb53-1315"><a href="#cb53-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1316"><a href="#cb53-1316" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-1317"><a href="#cb53-1317" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`starts_with()`</span> : Selects columns ending in a character string</span>
<span id="cb53-1318"><a href="#cb53-1318" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ends_with()`</span> : Selects columns ending in a character string</span>
<span id="cb53-1319"><a href="#cb53-1319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`contains()`</span> : Selects columns containing a character string, not necessarily at the start or end</span>
<span id="cb53-1320"><a href="#cb53-1320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`all_of()`</span> : Selects all of the column names in a vector e.g., <span class="in">`all_of(c("a", "b"))`</span></span>
<span id="cb53-1321"><a href="#cb53-1321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`any_of()`</span> : Selects any of the column names in a vector that are present, silently dropping missing ones. This can be very useful when columns may or may not be present, but has the risk of creating silent errors.</span>
<span id="cb53-1322"><a href="#cb53-1322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`where()`</span> : Select columns that meet a criterion, e.g., <span class="in">`where(is.numeric)`</span> selects only columns containing numeric data.</span>
<span id="cb53-1323"><a href="#cb53-1323" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`everything()`</span> : Selects all columns.</span>
<span id="cb53-1324"><a href="#cb53-1324" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1325"><a href="#cb53-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1326"><a href="#cb53-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">### Positive vs. negative selections and filters</span></span>
<span id="cb53-1327"><a href="#cb53-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1328"><a href="#cb53-1328" aria-hidden="true" tabindex="-1"></a>Explain the difference between positive and negative selections in <span class="in">`select()`</span> and <span class="in">`filter()`</span> and how they are done in each.</span>
<span id="cb53-1329"><a href="#cb53-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1330"><a href="#cb53-1330" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-1331"><a href="#cb53-1331" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In <span class="in">`select()`</span>, positive selections mean *keep* these columns (e.g., `select(mpg, cyl)`), while negative selections mean *drop* these columns (e.g., <span class="in">`select(-mpg, -cyl)`</span>).</span>
<span id="cb53-1332"><a href="#cb53-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In <span class="in">`filter()`</span>, conditions act positively by default (e.g., <span class="in">`filter(mpg &gt; 20)`</span> keeps rows with mpg <span class="sc">\&gt;</span> 20). To "negate" a condition, you use <span class="in">`!`</span> or inequality operators (e.g., <span class="in">`filter(!(mpg &gt; 20))`</span> or <span class="in">`filter(mpg &lt;= 20)`</span>).</span>
<span id="cb53-1333"><a href="#cb53-1333" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1334"><a href="#cb53-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1335"><a href="#cb53-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">### Set operators</span></span>
<span id="cb53-1336"><a href="#cb53-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1337"><a href="#cb53-1337" aria-hidden="true" tabindex="-1"></a>What set operators can be used with <span class="in">`select()`</span> and how?</span>
<span id="cb53-1338"><a href="#cb53-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1339"><a href="#cb53-1339" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-1340"><a href="#cb53-1340" aria-hidden="true" tabindex="-1"></a><span class="in">`select()`</span> supports set operations on columns using tidyselect helpers:</span>
<span id="cb53-1341"><a href="#cb53-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1342"><a href="#cb53-1342" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`-`</span> : negative selection (drop columns)\</span>
<span id="cb53-1343"><a href="#cb53-1343" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`c()`</span> : combine multiple selections (union)\</span>
<span id="cb53-1344"><a href="#cb53-1344" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`!`</span> : invert a selection rule\</span>
<span id="cb53-1345"><a href="#cb53-1345" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&amp;`</span> : must meet *both* selection rules (intersection)\</span>
<span id="cb53-1346"><a href="#cb53-1346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`|`</span> : can meet *either* selection rule (union)</span>
<span id="cb53-1347"><a href="#cb53-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1348"><a href="#cb53-1348" aria-hidden="true" tabindex="-1"></a>Example:</span>
<span id="cb53-1349"><a href="#cb53-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1350"><a href="#cb53-1350" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb53-1351"><a href="#cb53-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(dat, <span class="fu">contains</span>(<span class="st">"scale3"</span>) <span class="sc">&amp;</span> <span class="fu">contains</span>(<span class="st">"item1"</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">ends_with</span>(<span class="st">"item1"</span>))</span>
<span id="cb53-1352"><a href="#cb53-1352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1353"><a href="#cb53-1353" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1354"><a href="#cb53-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1355"><a href="#cb53-1355" aria-hidden="true" tabindex="-1"></a>What set operators can be used with <span class="in">`filter()`</span> and how?</span>
<span id="cb53-1356"><a href="#cb53-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1357"><a href="#cb53-1357" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true" title="Click to show answer"}</span>
<span id="cb53-1358"><a href="#cb53-1358" aria-hidden="true" tabindex="-1"></a>With filter(), set operations are expressed with logical operators applied to rows: </span>
<span id="cb53-1359"><a href="#cb53-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1360"><a href="#cb53-1360" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&amp;`</span> : keeps rows that satisfy all conditions (intersection)</span>
<span id="cb53-1361"><a href="#cb53-1361" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`|`</span> : keeps rows that satisfy any condition (union)</span>
<span id="cb53-1362"><a href="#cb53-1362" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`!`</span> : excludes rows that meet a condition (negation/difference)</span>
<span id="cb53-1363"><a href="#cb53-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1364"><a href="#cb53-1364" aria-hidden="true" tabindex="-1"></a>Example:</span>
<span id="cb53-1365"><a href="#cb53-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1368"><a href="#cb53-1368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1369"><a href="#cb53-1369" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb53-1370"><a href="#cb53-1370" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: true</span></span>
<span id="cb53-1371"><a href="#cb53-1371" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span></span>
<span id="cb53-1372"><a href="#cb53-1372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gender <span class="sc">==</span> <span class="st">"female"</span> <span class="sc">&amp;</span> age <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(income))</span>
<span id="cb53-1373"><a href="#cb53-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1374"><a href="#cb53-1374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-1375"><a href="#cb53-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1376"><a href="#cb53-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interactive exercises</span></span>
<span id="cb53-1377"><a href="#cb53-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1378"><a href="#cb53-1378" aria-hidden="true" tabindex="-1"></a>Complete the interactive exercises for:</span>
<span id="cb53-1379"><a href="#cb53-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1380"><a href="#cb53-1380" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`select()`</span><span class="co">](https://errors.shinyapps.io/dplyr-learnr/#section-dplyrselect)</span></span>
<span id="cb53-1381"><a href="#cb53-1381" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`relocate()`</span><span class="co">](https://errors.shinyapps.io/dplyr-learnr/#section-dplyrrelocate)</span></span>
<span id="cb53-1382"><a href="#cb53-1382" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`filter()`</span><span class="co">](https://errors.shinyapps.io/dplyr-learnr/#section-dplyrfilter)</span></span>
<span id="cb53-1383"><a href="#cb53-1383" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`mutate()`</span><span class="co">](https://errors.shinyapps.io/dplyr-learnr/#section-dplyrmutate)</span></span>
<span id="cb53-1384"><a href="#cb53-1384" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`case_when()`</span><span class="co">](https://errors.shinyapps.io/dplyr-learnr/#section-dplyrcase_when)</span></span>
<span id="cb53-1385"><a href="#cb53-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1386"><a href="#cb53-1386" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practice data transformation using multiple functions</span></span>
<span id="cb53-1387"><a href="#cb53-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1388"><a href="#cb53-1388" aria-hidden="true" tabindex="-1"></a>In your local version of this .qmd file:</span>
<span id="cb53-1389"><a href="#cb53-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1390"><a href="#cb53-1390" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use the 'dat_demographics_messy' to create a new data frame called 'dat_age_tidier'</span>
<span id="cb53-1391"><a href="#cb53-1391" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use <span class="in">`disinct()`</span> to understand what unique responses are present in the 'age' column.</span>
<span id="cb53-1392"><a href="#cb53-1392" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use the other functions you learned in this chapter to clean the age column so that it contains only numbers.</span>
<span id="cb53-1393"><a href="#cb53-1393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the age variable to a numeric variable with <span class="in">`as.numeric()`</span>.</span>
<span id="cb53-1394"><a href="#cb53-1394" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Print the unique responses present in the processed 'age' column as a table.</span>
<span id="cb53-1395"><a href="#cb53-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1398"><a href="#cb53-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1399"><a href="#cb53-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb53-1400"><a href="#cb53-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1401"><a href="#cb53-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1402"><a href="#cb53-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1403"><a href="#cb53-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>